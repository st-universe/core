<html xmlns:stu="stu">
<metal:macro metal:define-macro="shiplist_header">
  <tr>
    <th style="width: 140px;">Klasse</th>
    <th>Name</th>
    <th style="width: 30px;"></th>
    <th style="width: 70px;" title="im System (außerhalb)">x|y <img src="assets/buttons/info2.png"
        style="height:16px;" /></th>
    <th style="width: 100px;" title="aktuell/maximal">Hülle <img src="assets/buttons/info2.png" style="height:16px;" />
    </th>
    <th style="width: 160px;" title="aktuell/maximal (Regeneration [alle 15min])">Schilde <img
        src="assets/buttons/info2.png" style="height:16px;" /></th>
    <th style="width: 160px;" title="aktuell/maximal, Zuwachs, (System-Verbrauch/Warpkern-Nutzung)">Energie <img
        src="assets/buttons/info2.png" style="height:16px;" /></th>
    <th style="width: 120px;" title="Warpkern, Ersatzbatterie">Versorgung <img src="assets/buttons/info2.png"
        style="height:16px;" /></th>
    <th style="width: 90px; text-align: center;">Crew</th>
    <th style="width: 125px; text-align: center;">Systeme</th>
    <th style="width: 35px;"></th>
  </tr>
</metal:macro>
<metal:macro metal:define-macro="nbsblock">
  <tal:block tal:condition="not:HAS_NBS">
    <table tal:condition="not:CLOAK_NBS" class="tcal">
      <tr>
        <td>Es befinden sich keine Schiffe in diesem Sektor</td>
      </tr>
    </table>
  </tal:block>
  <tal:block tal:condition="CLOAK_NBS">
    <table class="tcal">
      <tr>
        <td style="color: #f1a005;">Es befinden sich getarnte Schiffe in diesem Sektor</td>
      </tr>
    </table>
  </tal:block>
  <tal:block tal:condition="HAS_NBS">
    <table class="tcal nbs" id="nbstab">
      <metal:block metal:use-macro="nbslist_header" />
      <tal:block tal:condition="STATION_NBS">
        <tr>
          <td colspan="2"></td>
          <td colspan="4">Stationen</td>
        </tr>
        <tr tal:repeat="ship STATION_NBS" tal:attributes="class string:row${repeat/ship/odd}">
          <form id="nbsf_${ship/getId}" method="post" action="ship.php">
            <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
            <input type="hidden" name="target" tal:attributes="value ship/getId" />
            <input type="hidden" name="B_ATTACK_SHIP" value="1" />
            <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
            <metal:block metal:use-macro="nbslist_body" />
          </form>
        </tr>
      </tal:block>
      <tal:block tal:condition="FLEET_NBS">
        <tal:block tal:repeat="data FLEET_NBS">
          <tal:block tal:condition="not:data/isHidden">
            <tr>
              <td colspan="2">
                <span tal:replace="data/getVisibleShipsCount">COUNT</span> Schiffe
                <tal:block tal:condition="data/showManagement">
                  <tal:block tal:condition="not:SHIP/getFleetId">
                    (<a href="?B_JOIN_FLEET=1&id=${SHIP/getId}&fleetid=${data/getId}" title="Flotte beitreten">+</a>)
                  </tal:block>
                </tal:block>
              </td>
              <td colspan="3">
                <img tal:condition="data/getDefendedColony" src="/assets/buttons/defend1.png"
                  title="verteidigt die Kolonie" />
                <img tal:condition="data/getBlockedColony" src="/assets/buttons/block1.png"
                  title="blockiert die Kolonie" />
                <span tal:condition="not:data/showManagement" tal:content="structure bbcode:data/getName">NAME</span>
                <tal:block tal:condition="data/showManagement">
                  <a href="?SHOW_SHIP=1&id=${data/getLeadShip/getId}"
                    tal:content="structure bbcode:data/getName">NAME</a>
                </tal:block>
                <span id="hidefleet${data/getId}">
                  (<a href="javascript:void(0);" onclick="hideFleet(${data/getId});">zuklappen</a>)
                </span>
                <span style="display: none;" id="showfleet${data/getId}">
                  (<a href="javascript:void(0);" onclick="showFleet(${data/getId});">aufklappen</a>)
                </span>
                <span tal:condition="php: SHIP.isBase() AND data.getLeadShip().isOwnedByCurrentUser()">
                  (<a
                    href="station.php?B_DOCK_FLEET=1&id=${SHIP/getId}&fid=${data/getId}&sstr=${THIS/getSessionString}">andocken</a>)
                </span>
              </td>
              <td>
                <div id="fleetuser${data/getId}" style="display: none;">
                  <a href="javascript:void(0);" onclick="openPmWindow(${data/getUserId})"
                    title="Nachricht an ${bbcode2txt:data/getUserName} verfassen"
                    onmouseover="cp('nbsPm${data/getId}','buttons/msg2')"
                    onmouseout="cp('nbsPm${data/getId}','buttons/msg1')">
                    <img src="/assets/buttons/msg1.png" name="nbsPm${data/getId}" />
                  </a>
                  <span tal:content="structure bbcode:data/getUserName">USERNAME</span>
                  (${data/getUserId})
                </div>
              </td>
            </tr>
            <tal:block tal:repeat="ship data/getVisibleShips">
              <tr tal:attributes="class string:row${repeat/ship/odd} fleet${data/getId}">
                <form id="nbsf_${ship/getId}" method="post" action="ship.php">
                  <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
                  <input type="hidden" name="target" tal:attributes="value ship/getId" />
                  <input type="hidden" name="B_ATTACK_SHIP" value="1" />
                  <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
                  <metal:block metal:use-macro="nbslist_body" />
                </form>
              </tr>
            </tal:block>
          </tal:block>
          <tal:block tal:condition="data/isHidden">
            <tr>
              <td colspan="2">
                <span tal:replace="data/getVisibleShipsCount">COUNT</span> Schiffe
                <tal:block tal:condition="data/showManagement">
                  <tal:block tal:condition="not:SHIP/getFleetId">
                    (<a href="?B_JOIN_FLEET=1&id=${SHIP/getId}&fleetid=${data/getId}" title="Flotte beitreten">+</a>)
                  </tal:block>
                </tal:block>
              </td>
              <td colspan="3">
                <img tal:condition="data/getDefendedColony" src="/assets/buttons/defend1.png"
                  title="verteidigt die Kolonie" />
                <img tal:condition="data/getBlockedColony" src="/assets/buttons/block1.png"
                  title="blockiert die Kolonie" />
                <span tal:condition="not:data/showManagement" tal:content="structure bbcode:data/getName">NAME</span>
                <tal:block tal:condition="data/showManagement">
                  <a href="?SHOW_SHIP=1&id=${data/getLeadShip/getId}"
                    tal:content="structure bbcode:data/getName">NAME</a>
                </tal:block>
                <span style="display: none;" id="hidefleet${data/getId}">
                  (<a href="javascript:void(0);" onclick="hideFleet(${data/getId});">zuklappen</a>)
                </span>
                <span id="showfleet${data/getId}">
                  (<a href="javascript:void(0);" onclick="showFleet(${data/getId});">aufklappen</a>)
                </span>
                <span tal:condition="php: SHIP.isBase() AND data.getLeadShip().isOwnedByCurrentUser()">
                  (<a
                    href="station.php?B_DOCK_FLEET=1&id=${SHIP/getId}&fid=${data/getId}&sstr=${THIS/getSessionString}">andocken</a>)
                </span>
              </td>
              <td>
                <div id="fleetuser${data/getId}">
                  <a href="javascript:void(0);" onclick="openPmWindow(${data/getUserId})"
                    title="Nachricht an ${bbcode2txt:data/getUserName} verfassen"
                    onmouseover="cp('nbsPm${data/getId}','buttons/msg2')"
                    onmouseout="cp('nbsPm${data/getId}','buttons/msg1')">
                    <img src="/assets/buttons/msg1.png" name="nbsPm${data/getId}" />
                  </a>
                </div>
              </td>
            </tr>
            <tal:block tal:repeat="ship data/getVisibleShips">
              <tr tal:attributes="class string:row${repeat/ship/odd} fleet${data/getId}" style="display: none;">
                <form id="nbsf_${ship/getId}" method="post" action="ship.php">
                  <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
                  <input type="hidden" name="target" tal:attributes="value ship/getId" />
                  <input type="hidden" name="B_ATTACK_SHIP" value="1" />
                  <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
                  <metal:block metal:use-macro="nbslist_body" />
                </form>
              </tr>
            </tal:block>
          </tal:block>
        </tal:block>
      </tal:block>
      <tal:block tal:condition="SHIP_NBS">
        <tr>
          <td colspan="2"></td>
          <td colspan="4">Einzelschiffe</td>
        </tr>
        <tr tal:repeat="ship SHIP_NBS" tal:attributes="class string:row${repeat/ship/odd}">
          <form id="nbsf_${ship/getId}" method="post" action="ship.php">
            <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
            <input type="hidden" name="target" tal:attributes="value ship/getId" />
            <input type="hidden" name="B_ATTACK_SHIP" value="1" />
            <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
            <metal:block metal:use-macro="nbslist_body" />
          </form>
        </tr>
      </tal:block>
    </table>
  </tal:block>
</metal:macro>
<metal:macro metal:define-macro="shiplist_body">
  <tr tal:attributes="class string:row${repeat/ship/odd}">
    <td style="background-color: #000000 ! important">
      <a href="ship.php?SHOW_SHIP=1&id=${ship/getId}">
        <metal:macro metal:use-macro="shipimage" />
      </a>
    </td>
    <td>
      <a href="ship.php?SHOW_SHIP=1&id=${ship/getId}">
        <img tal:condition="ship/getDockedTo" src="assets/buttons/dock2.png" title="Schiff ist angedockt"
          style="height:20px;" />
        <img tal:condition="php:ship.getState() EQ 1" src="assets/buttons/rep2.png"
          tal:attributes="title string:Schiff wird repariert (noch ${ship/getRepairDuration} Runden)"
          style="height:20px;" />
        <img tal:condition="php:ship.getState() EQ 4" src="assets/buttons/rep2.png"
          tal:attributes="title string:Schiffscrew repariert das Schiff" style="height:20px;" />
        <img tal:condition="php:ship.getState() EQ 2" src="assets/buttons/map1.png" title="Schiff kartographiert"
          style="height:20px;" />
        <span tal:content="structure bbcode:ship/getName">NAME</span>
      </a>
    </td>
    <td style="text-align: center;">
      <img src="assets/buttons/alert${ship/getAlertState}_1.png" title="Alarmstufe" />
    </td>
    <td align="center" tal:condition="ship/getSystem">
      ${ship/getPosX}|${ship/getPosY}<br />
      (${ship/getCx}|${ship/getCy})
    </td>
    <td align="center" tal:condition="not:ship/getSystem">
      (${ship/getCx}|${ship/getCy})
    </td>
    <td>
      <span tal:attributes="style string:${ship/getHullColorStyle};">${ship/getHuell}</span>/${ship/getMaxHuell}
    </td>
    <td>
      <span tal:condition="ship/getShieldState" class="activeshield"
        tal:content="string:${ship/getShield}/${ship/getMaxShield}">..</span>
      <span tal:condition="not:ship/getShieldState">${ship/getShield}/${ship/getMaxShield}</span>
      (+<span tal:replace="ship/getShieldRegenerationRate">REGENERATIONRATE</span>)
    </td>
    <td>
      ${ship/getEps}/${ship/getMaxEps}
      <span>${addPlusCharacter:ship/getEffectiveEpsProduction}</span>
      (<span tal:content="ship/getEpsUsage" class="neg">USAGE</span>/<span class="neg"
        tal:content="ship/getWarpcoreUsage">CORE</span>)
    </td>
    <td>
      <div style="float: left; width: 50%">
        <img src="assets/buttons/warpk.png" title="Warpkern" /> <span tal:replace="ship/getWarpcoreLoad">Warpcore</span>
      </div>
      <div style="float: left; width: 50%">
        <img src="assets/buttons/batt.png" title="Ersatzbatterie" /> <span tal:replace="ship/getEBatt">BATTERY</span>
      </div>
    </td>
    <td tal:content="ship/getCrewCount" style="text-align: center;">CREW</td>
    <td>
      <img src="assets/buttons/kss1.png" tal:condition="ship/getNbs" title="Nahbereichssensoren aktiviert" />
      <img src="assets/buttons/kss2.png" tal:condition="not:ship/getNbs" title="Nahbereichssensoren deaktiviert" />
      <img src="assets/buttons/lss1.png" tal:condition="ship/getLss" title="Langstreckensensoren aktiviert" />
      <img src="assets/buttons/lss2.png" tal:condition="not:ship/getLss" title="Langstreckensensoren deaktiviert" />
      <tal:block tal:condition="ship/hasPhaser">
        <img src="assets/buttons/act_phaser1.png" tal:condition="ship/getPhaser" title="Strahlenwaffe aktiviert" />
        <img src="assets/buttons/act_phaser2.png" tal:condition="not:ship/getPhaser"
          title="Strahlenwaffe deaktiviert" />
      </tal:block>
      <tal:block tal:condition="ship/hasTorpedo">
        <img src="assets/buttons/act_torp1.png" tal:condition="ship/getTorpedos" title="Torpedobänke aktiviert" />
        <img src="assets/buttons/act_torp2.png" tal:condition="not:ship/getTorpedos" title="Torpedobände deaktiviert" />
      </tal:block>
      <tal:block tal:condition="ship/hasCloak">
        <img src="assets/buttons/tarn1.png" tal:condition="ship/getCloakState" title="Tarnung aktiviert" />
        <img src="assets/buttons/tarn2.png" tal:condition="not:ship/getCloakState" title="Tarnung deaktiviert" />
      </tal:block>
    </td>
    <td style="text-align: center;">
      <tal:block tal:condition="ship/getFleet">
        <a href="?B_DELETE_FLEET=1&id=${ship/getId}&sstr=${THIS/getSessionString}" tal:condition="ship/isFleetLeader"
          onmouseover="cp('fleet_${ship/getId}','buttons/fl_flag3')"
          onmouseout="cp('fleet_${ship/getId}','buttons/fl_flag2')">
          <img src="assets/buttons/fl_flag2.png" name="fleet_${ship/getId}" title="Flotte auflösen" />
        </a>
        <a href="?B_LEAVE_FLEET=1&id=${ship/getId}&sstr=${THIS/getSessionString}" tal:condition="not:ship/isFleetLeader"
          onmouseover="cp('fleet_${ship/getId}','buttons/fl_raus2')"
          onmouseout="cp('fleet_${ship/getId}','buttons/fl_raus1')">
          <img src="assets/buttons/fl_raus1.png" name="fleet_${ship/getId}" title="Flotte verlassen" />
        </a>
      </tal:block>
      <tal:block tal:condition="not:ship/getFleet">
        <a href="?B_NEW_FLEET=1&id=${ship/getId}" tal:condition="not:ship/isBase"
          onmouseover="cp('fleet_${ship/getId}','buttons/fl_flag2')"
          onmouseout="cp('fleet_${ship/getId}','buttons/fl_flag1')">
          <img src="assets/buttons/fl_flag1.png" name="fleet_${ship/getId}" title="Flotte erstellen" />
        </a>
      </tal:block>
    </td>
  </tr>
</metal:macro>
<metal:macro metal:define-macro="shipimage">
  <img tal:condition="ship/getCloakState" src="assets/ships/${ship/getRumpId}_cloaked.png" style="opacity:0.55;"
    tal:attributes="title ship/getRumpName" />
  <img tal:condition="not:ship/getCloakState" src="assets/ships/${ship/getRumpId}.png"
    tal:attributes="title ship/getRumpName" />
</metal:macro>
<metal:macro metal:define-macro="hiddenshipid" phptal:cache="1m per SHIP/getId">
  <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
</metal:macro>
<metal:block metal:define-macro="nbslist_header">
  <tr>
    <td class="darkbg" style="font-weight: bold; width: 60px;" colspan="2">Aktionen</td>
    <td class="darkbg"></td>
    <td class="darkbg" style="font-weight: bold;">Name</td>
    <td class="darkbg" style="font-weight: bold;">Zustand</td>
    <td class="darkbg" style="font-weight: bold;">Siedler</td>
  </tr>
</metal:block>
<metal:block metal:define-macro="nbslist_body">
  <tal:block tal:condition="SHIP/displayNbsActions"
    tal:define="sstr string:${THIS/getSessionString}; nameWithoutMarkup bbcode2txt:ship/getName">
    <td style="width: 30px; text-align: center;">
      <tal:block tal:condition="php:SHIP.canAttack() AND (ship.getCloakState() OR ship.canBeAttacked())">
        <div style="cursor: pointer;" onClick="$('nbsf_${ship/getId}').submit();"
          onmouseover="cp('att_${ship/getId}','buttons/phaser2')"
          onmouseout="cp('att_${ship/getId}','buttons/phaser1')">
          <img src="assets/buttons/phaser1.png" name="att_${ship/getId}" title="${nameWithoutMarkup} angreifen" />
        </div>
      </tal:block>
    </td>
    <td style="width: 120px;">
      <div style="float:left; margin-right:4px;" tal:condition="not:ship/getCloakState">
        <a href="javascript:void(0);" onclick="showScanWindow(${SHIP/getId},${ship/getId})"
          onmouseover="cp('scn_${ship/getId}','buttons/lupe2')" onmouseout="cp('scn_${ship/getId}','buttons/lupe1')">
          <img src="assets/buttons/lupe1.png" name="scn_${ship/getId}" title="${nameWithoutMarkup} scannen" />
        </a>
      </div>
      <div style="float:left; margin-right:4px;" tal:condition="SHIP/canIntercept">
        <a tal:condition="php: ship.isInterceptable() AND SHIP.hasWarpdrive()"
          href="?B_INTERCEPT=1&id=${SHIP/getId}&target=${ship/getId}&sstr=${THIS/getSessionString}"
          onmouseover="cp('int_${ship/getId}','buttons/inc2')" onmouseout="cp('int_${ship/getId}','buttons/inc1')">
          <img src="assets/buttons/inc1.png" name="int_${ship/getId}" title="${nameWithoutMarkup} abfangen" />
        </a>
      </div>
      <tal:block tal:condition="not:ship/getWarpState">
        <tal:block tal:condition="not:ship/getCloakState">
          <div style="float:left; margin-right:4px;">
            <a href="javascript:void(0);" tal:condition="not:ship/getIsDestroyed"
              onclick="showETransferWindow(${ship/getId})" onmouseover="cp('etr_${ship/getId}','buttons/e_trans2')"
              onmouseout="cp('etr_${ship/getId}','buttons/e_trans1')">
              <img src="assets/buttons/e_trans1.png" name="etr_${ship/getId}"
                title="Energie zur ${nameWithoutMarkup} transferieren" />
            </a>
          </div>
          <div style="float:left; margin-right:4px;">
            <a href="javascript:void(0);" onclick="showBToWindow(${ship/getId})"
              onmouseover="cp('bto_${ship/getId}','buttons/b_down2')"
              onmouseout="cp('bto_${ship/getId}','buttons/b_down1')">
              <img src="assets/buttons/b_down1.png" name="bto_${ship/getId}"
                title="Zur ${nameWithoutMarkup} runterbeamen" />
            </a>
            <a href="javascript:void(0);" onclick="showBFromWindow(${ship/getId})"
              onmouseover="cp('bfr_${ship/getId}','buttons/b_up2')"
              onmouseout="cp('bfr_${ship/getId}','buttons/b_up1')">
              <img src="assets/buttons/b_up1.png" name="bfr_${ship/getId}"
                title="Von der ${nameWithoutMarkup} hochbeamen" />
            </a>
          </div>
          <div style="float:left; margin-right:4px;"
            tal:condition="php:(ship.isOwnedByCurrentUser() OR ship.hasUplink()) AND SHIP.isTroopQuartersHealthy()">
            <a href="javascript:void(0);" onclick="showBTroopTransferWindow(${ship/getId}, false, true);">
              <img src="assets/buttons/bt_down1.png" title="Truppen zur ${nameWithoutMarkup} beamen" />
            </a>
            <a href="javascript:void(0);" onclick="showBTroopTransferWindow(${ship/getId}, false, false);">
              <img src="assets/buttons/bt_up1.png" title="Truppen von der ${nameWithoutMarkup} beamen" />
            </a>
          </div>
          <div style="float:left; margin-right:4px;" tal:condition="SHIP/isTorpedoStorageHealthy">
            <a href="javascript:void(0);" onclick="showBTorpTransferWindow(${ship/getId}, true);">
              <img src="assets/buttons/btorp_down1.png" title="Torpedos zur ${nameWithoutMarkup} beamen" />
            </a>
            <a href="javascript:void(0);" onclick="showBTorpTransferWindow(${ship/getId}, false);">
              <img src="assets/buttons/btorp_up1.png" title="Torpedos von der ${nameWithoutMarkup} beamen" />
            </a>
          </div>
          <div style="float:left; margin-right:4px;"
            tal:condition="php:!ship.traktorbeamNotPossible() AND !SHIP.isTraktorBeamActive()">
            <a href="?B_ACTIVATE_TRAKTOR=1&id=${SHIP/getId}&target=${ship/getId}&sstr=${sstr}"
              onmouseover="cp('tra_${ship/getId}','buttons/trak2')"
              onmouseout="cp('tra_${ship/getId}','buttons/trak1')">
              <img src="assets/buttons/trak1.png" name="tra_${ship/getId}"
                title="Traktorstrahl auf die ${nameWithoutMarkup} richten" />
            </a>
          </div>
          <div style="float:left; margin-right:4px;"
            tal:condition="php:ship.isOwnedByCurrentUser() AND ship.isShuttle() AND SHIP.hasFreeShuttleSpace()">
            <a href="?B_STORE_SHUTTLE=1&id=${SHIP/getId}&target=${ship/getId}&sstr=${sstr}"
              onmouseover="cp('store_${ship/getId}','buttons/landshuttle2', 'png')"
              onmouseout="cp('store_${ship/getId}','buttons/landshuttle1', 'png')">
              <img src="assets/buttons/landshuttle1.png" name="store_${ship/getId}" title="Shuttle aufsammeln" />
            </a>
          </div>
          <div style="float:left; margin-right:4px;"
            tal:condition="php:SHIP.isShuttle() AND ship.isOwnedByCurrentUser()">
            <a href="?B_LAND_SHUTTLE=1&id=${ship/getId}&shuttle=${SHIP/getId}&sstr=${sstr}"
              onmouseover="cp('land_${ship/getId}','buttons/landshuttle2', 'png')"
              onmouseout="cp('land_${ship/getId}','buttons/landshuttle1', 'png')">
              <img src="assets/buttons/landshuttle1.png" name="land_${ship/getId}" title="In Shuttle-Rampe landen" />
            </a>
          </div>
        </tal:block>
        <div style="float:left; margin-right:4px;" tal:condition="php: ship.isBase() AND NOT ship.getIsDestroyed()">
          <a tal:condition="not:SHIP/getDockedTo"
            href="?B_DOCK=1&id=${SHIP/getId}&target=${ship/getId}&sstr=${THIS/getSessionString}"
            onmouseover="cp('dock_${ship/getId}','buttons/dock2')"
            onmouseout="cp('dock_${ship/getId}','buttons/dock1')">
            <img src="assets/buttons/dock1.png" name="dock_${ship/getId}"
              title="An die ${nameWithoutMarkup} andocken" />
          </a>
        </div>
      </tal:block>
      <tal:block tal:condition="ship/getWarpState">
        <span style="width: 100%; color: #474791;">Im Warp</span>
      </tal:block>
    </td>
  </tal:block>
  <tal:block tal:condition="not:SHIP/displayNbsActions">
    <td colspan="2" style="text-align: center;">
      <tal:block tal:condition="SHIP/getWarpState">
        <tal:block tal:condition="SHIP/canIntercept">
          <a tal:condition="php: ship.isInterceptable() AND SHIP.hasWarpdrive()"
            href="?B_INTERCEPT=1&id=${SHIP/getId}&target=${ship/getId}&sstr=${THIS/getSessionString}"
            onmouseover="cp('int_${ship/getId}','buttons/inc2')" onmouseout="cp('int_${ship/getId}','buttons/inc1')">
            <img src="assets/buttons/inc1.png" name="int_${ship/getId}" title="${bbcode2txt:ship/getName} abfangen" />
          </a>
        </tal:block>
        <a tal:condition="not:ship/getCloakState" href="javascript:void(0);"
          onclick="showScanWindow(${SHIP/getId},${ship/getId})" onmouseover="cp('scn_${ship/getId}','buttons/lupe2')"
          onmouseout="cp('scn_${ship/getId}','buttons/lupe1')">
          <img src="assets/buttons/lupe1.png" name="scn_${ship/getId}" title="${bbcode2txt:ship/getName} scannen" />
        </a>
        <span style="width: 100%; color: #474791;">Warpantrieb aktiv</span>
      </tal:block>
      <div style="width: 100%; color: #404040;" tal:condition="SHIP/getCloakState">Tarnung aktiv</div>
    </td>
  </tal:block>
  <tal:block tal:condition="ship/isOwnedByCurrentUser">
    <td style="width: 200px; background-color: #000000 !important;">
      <a href="ship.php?SHOW_SHIP=1&id=${ship/getId}">
        <metal:macro metal:use-macro="shipimage" />
      </a>
    </td>
    <td>
      <a href="ship.php?SHOW_SHIP=1&id=${ship/getId}"><span tal:content="structure bbcode:ship/getName">.</span></a>
    </td>
  </tal:block>
  <tal:block tal:condition="not:ship/isOwnedByCurrentUser">
    <td style="width: 200px; background-color: #000000 !important;">
      <metal:macro metal:use-macro="shipimage" />
    </td>
    <td>
      <span tal:content="structure bbcode:ship/getName">.</span>
    </td>
  </tal:block>
  <tal:block tal:condition="not:ship/isTrumfield">
    <td style="width: 160px;">
      <span tal:replace="ship/getHuell"></span>/<span tal:replace="ship/getMaxHuell"></span>
      <tal:block tal:condition="ship/getShieldState">
        (<span class="activeshield">${ship/getShield}</span>)
      </tal:block>
    </td>
    <td>
      <a href="javascript:void(0);" onclick="openPmWindow(${ship/getUserId})"
        title="Nachricht an ${bbcode2txt:ship/getUserName} verfassen"
        onmouseover="cp('nbsPm${ship/getId}','buttons/msg2')" onmouseout="cp('nbsPm${ship/getId}','buttons/msg1')">
        <img src="/assets/buttons/msg1.png" name="nbsPm${ship/getId}" /></a>
      <span tal:replace="structure bbcode:ship/getUserName">USERNAME</span> (${ship/getUserId})
    </td>
  </tal:block>
  <tal:block tal:condition="ship/isTrumfield">
    <td style="width: 160px;" tal:content="ship/getHuell">HULL</td>
    <td>
      <span tal:replace="structure bbcode:ship/getUserName">USERNAME</span>
    </td>
  </tal:block>
</metal:block>
<metal:block metal:define-macro="initial_js">
  <script language="Javascript">
    var sstr = '${THIS/getSessionString}';
    var shipid = ${ SHIP/getId};
  </script>
  <script type="text/javascript" src="${THIS/getJavascriptPath}/js/ship.js">< !--stuniverse --></script>
  <script type="text/javascript" src="${THIS/getJavascriptPath}/js/shipmanagement.js">< !--stuniverse --></script>
  <script type="text/javascript" src="${THIS/getJavascriptPath}/js/station.js">< !--stuniverse --></script>
</metal:block>
<metal:block metal:define-macro="show_ship_alvl">
  <table style="width: 100%;" tal:define="sstr THIS/getSessionString">
    <tr>
      <td>
        <a href="?B_SET_GREEN_ALERT=1&id=${SHIP/getId}&sstr=${sstr}">
          <img src="assets/buttons/alert1.png" /> Alarmstufe Grün
        </a>
      </td>
    </tr>
    <tr>
      <td>
        <a href="?B_SET_YELLOW_ALERT=1&id=${SHIP/getId}&sstr=${sstr}">
          <img src="assets/buttons/alert2.png" /> Alarmstufe Gelb
        </a>
      </td>
    </tr>
    <tr>
      <td>
        <a href="?B_SET_RED_ALERT=1&id=${SHIP/getId}&sstr=${sstr}">
          <img src="assets/buttons/alert3.png" /> Alarmstufe Rot
        </a>
      </td>
    </tr>
  </table>
</metal:block>
<metal:block metal:define-macro="show_ship_etransfer">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value targetShip/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td>Ziel: <span tal:replace="structure bbcode:targetShip/getName">...</span></td>
      </tr>
      <tr>
        <td>Verfügbare Energie: ${SHIP/getEps}/${SHIP/getMaxEps}</td>
      </tr>
      <tr>
        <td>
          <img src="assets/buttons/e_trans2.png" title="Energietransfer" />
          <input type="text" size="4" name="ecount" id="etransfer_value" />
          <input type="submit" class="button" value="transferieren" name="B_ETRANSFER" id="etransfer_button" />
          <input type="button" class="button" value="max" name="B_MAX_ETRANSFER"
            onclick="$('etransfer_value').value = '${SHIP/getEps}'; $('etransfer_button').click()" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="entity_not_available">
  <div class="box">
    <div class="box_body">Das Ziel wurde nicht gefunden</div>
  </div>
</metal:block>
<metal:block metal:define-macro="show_ship_beamto">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value targetShip/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td colspan="2">Ziel: <span tal:replace="structure bbcode:targetShip/getName">...</span></td>
      </tr>
      <tr>
        <td colspan="2">Kapazität pro 1 Energie: <span
            tal:replace="structure bbcode:SHIP/getRump/getBeamFactor">...</span></td>
      </tr>
      <tr>
        <td style="width: 100%;">
          <tal:block tal:condition="SHIP/getBeamableStorage" tal:repeat="good SHIP/getBeamableStorage">
            <input type="hidden" name="goods[]" tal:attributes="value good/getCommodity/getId" />
            <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
              <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
            </div>
            <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
              <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
            </div>
            <br tal:condition="repeat/good/odd" style="clear: both;" />
          </tal:block>
          <tal:block tal:condition="not:SHIP/getBeamableStorage">
            Keine Waren vorhanden
          </tal:block>
        </td>
        <td rowspan="2" style="height: 100%;">
          <table style="width: 100%; height: 100%;">
            <tr>
              <td style="text-align: center;">
                <a href="?SHOW_SHIP=1&id=${SHIP/getId}">
                  <img src="assets/ships/${SHIP/getRump/getId}.png" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center; height: 10%;">
                <a href="javascript:void(0);" onclick="triggerBeamFrom(${targetShip/getId})"
                  onmouseover="cp('beamtrigger','buttons/b_down2');" onmouseout="cp('beamtrigger','buttons/b_down1');">
                  <img src="assets/buttons/b_down1.png" name="beamtrigger" title="Beammodus wechseln" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center;">
                <img tal:condition="not:OWNS_TARGET" src="assets/ships/${targetShip/getRump/getId}.png" />
                <a tal:condition="OWNS_TARGET" href="?SHOW_SHIP=1&id=${targetShip/getId}">
                  <img src="assets/ships/${targetShip/getRump/getId}.png" />
                </a>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;">
          <input type="submit" class="button" value="Beamen" name="B_BEAMTO" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="show_ship_beamfrom">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value targetShip/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td colspan="2">Ziel: <span tal:replace="structure bbcode:targetShip/getName">...</span></td>
      </tr>
      <tr>
        <td colspan="2">Kapazität pro 1 Energie: <span
            tal:replace="structure bbcode:SHIP/getRump/getBeamFactor">...</span></td>
      </tr>
      <tr>
        <td style="width: 100%;">
          <tal:block tal:condition="targetShip/getBeamableStorage" tal:repeat="good targetShip/getBeamableStorage">
            <input type="hidden" name="goods[]" tal:attributes="value good/getCommodity/getId" />
            <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
              <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
            </div>
            <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
              <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
            </div>
            <br tal:condition="repeat/good/odd" style="clear: both;" />
          </tal:block>
          <tal:block tal:condition="not:targetShip/getBeamableStorage">
            Keine Waren vorhanden
          </tal:block>
        </td>
        <td rowspan="2" style="height: 100%;">
          <table style="width: 100%; height: 100%;">
            <tr>
              <td style="text-align: center;">
                <a href="?SHOW_SHIP=1&id=${SHIP/getId}">
                  <img src="assets/ships/${SHIP/getRump/getId}.png" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center; height: 10%;">
                <a href="javascript:void(0);" onclick="triggerBeamTo(${targetShip/getId})"
                  onmouseover="cp('beamtrigger','buttons/b_up2');" onmouseout="cp('beamtrigger','buttons/b_up1');">
                  <img src="assets/buttons/b_up1.png" name="beamtrigger" title="Beammodus wechseln" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center;">
                <img tal:condition="not:OWNS_TARGET" src="assets/ships/${targetShip/getRump/getId}.png" />
                <a tal:condition="OWNS_TARGET" href="?SHOW_SHIP=1&id=${targetShip/getId}">
                  <img src="assets/ships/${targetShip/getRump/getId}.png" />
                </a>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;">
          <input type="submit" class="button" value="Beamen" name="B_BEAMFROM" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="show_ship_beamto_colony">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value targetColony/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td colspan="2">Ziel: <span tal:replace="structure bbcode:targetColony/getName">...</span></td>
      </tr>
      <tr tal:condition="php:targetColony.getShieldState() AND NOT OWNS_TARGET">
        <td>Schildfrequenz:</td>
        <td><input type="text" size="3" name="frequency" class="goodAmount" /> MHz</td>
      </tr>
      <tr>
        <td colspan="2">Kapazität pro 1 Energie: <span
            tal:replace="structure bbcode:SHIP/getRump/getBeamFactor">...</span></td>
      </tr>
      <tr>
        <td style="width: 100%;">
          <tal:block tal:condition="SHIP/getBeamableStorage" tal:repeat="good SHIP/getBeamableStorage">
            <input type="hidden" name="goods[]" tal:attributes="value good/getCommodity/getId" />
            <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
              <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
            </div>
            <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
              <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
            </div>
            <br tal:condition="repeat/good/odd" style="clear: both;" />
          </tal:block>
          <tal:block tal:condition="not:SHIP/getBeamableStorage">
            Keine Waren vorhanden
          </tal:block>
        </td>
        <td rowspan="2" style="height: 100%;">
          <table style="width: 100%; height: 100%;">
            <tr>
              <td style="text-align: center;">
                <a href="?SHOW_SHIP=1&id=${SHIP/getId}">
                  <img src="assets/ships/${SHIP/getRump/getId}.png" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center; height: 10%;">
                <a href="javascript:void(0);" onclick="triggerBeamFromColony(${targetColony/getId})"
                  onmouseover="cp('beamtrigger','buttons/b_down2');" onmouseout="cp('beamtrigger','buttons/b_down1');">
                  <img src="assets/buttons/b_down1.png" name="beamtrigger" title="Beammodus wechseln" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center;">
                <img tal:condition="not:OWNS_TARGET" src="assets/planets/${targetColony/getColonyClass}.gif" />
                <a tal:condition="OWNS_TARGET" href="colony.php?SHOW_COLONY=1&id=${targetColony/getId}">
                  <img src="assets/planets/${targetColony/getColonyClass}.gif" />
                </a>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;">
          <input type="submit" class="button" value="Beamen" name="B_BEAMTO_COLONY" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="show_ship_beamfrom_colony">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value targetColony/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td colspan="2">Ziel: <span tal:replace="structure bbcode:targetColony/getName">...</span></td>
      </tr>
      <tr tal:condition="php:targetColony.getShieldState() AND NOT OWNS_TARGET">
        <td>Schildfrequenz:</td>
        <td><input type="text" size="3" name="frequency" class="goodAmount" /> MHz</td>
      </tr>
      <tr>
        <td colspan="2">Kapazität pro 1 Energie: <span
            tal:replace="structure bbcode:SHIP/getRump/getBeamFactor">...</span></td>
      </tr>
      <tr>
        <td style="width: 100%;">
          <tal:block tal:condition="targetColony/getBeamableStorage" tal:repeat="good targetColony/getBeamableStorage">
            <input type="hidden" name="goods[]" tal:attributes="value good/getGoodId" />
            <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
              <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
            </div>
            <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
              <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
            </div>
            <br tal:condition="repeat/good/odd" style="clear: both;" />
          </tal:block>
          <tal:block tal:condition="not:targetColony/getStorage">
            Keine Waren vorhanden
          </tal:block>
        </td>
        <td rowspan="2" style="height: 100%;">
          <table style="width: 100%; height: 100%;">
            <tr>
              <td style="text-align: center;">
                <a href="?SHOW_SHIP=1&id=${SHIP/getId}">
                  <img src="assets/ships/${SHIP/getRump/getId}.png" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center; height: 10%;">
                <a href="javascript:void(0);" onclick="triggerBeamToColony(${targetColony/getId})"
                  onmouseover="cp('beamtrigger','buttons/b_up2');" onmouseout="cp('beamtrigger','buttons/b_up1');">
                  <img src="assets/buttons/b_up1.png" name="beamtrigger" title="Beammodus wechseln" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center;">
                <img tal:condition="not:OWNS_TARGET" src="assets/planets/${targetColony/getColonyClass}.gif" />
                <a tal:condition="OWNS_TARGET" href="colony.php?SHOW_COLONY=1&id=${targetColony/getId}">
                  <img src="assets/planets/${targetColony/getColonyClass}.gif" />
                </a>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;">
          <input type="submit" class="button" value="Beamen" name="B_BEAMFROM_COLONY" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="show_troop_transfer">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value target/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />

    <tal:block tal:condition="IS_COLONY">
      <input type="hidden" name="isColony" tal:attributes="value IS_COLONY" />
    </tal:block>
    <tal:block tal:condition="IS_UNLOAD">
      <input type="hidden" name="isUnload" tal:attributes="value IS_UNLOAD" />
    </tal:block>
    <table class="tcal">
      <tr>
        <td>Ziel: <span tal:replace="structure bbcode:target/getName">...</span></td>
      </tr>
      <tr tal:condition="php: NOT IS_COLONY AND target.getBuildplan()">
        <td>Minimalcrew des Ziels: ${target/getBuildplan/getCrew}</td>
      </tr>
      <tr>
        <td>Verfügbare Truppen: ${MAXIMUM}</td>
      </tr>
      <tr>
        <td>
          <img tal:condition="IS_UNLOAD" src="assets/buttons/bt_down1.png" title="Truppen hinbeamen" />
          <img tal:condition="not:IS_UNLOAD" src="assets/buttons/bt_up1.png" title="Truppen wegbeamen" />
          <input type="text" size="4" name="tcount" id="ttransfer_value" />
          <input type="submit" class="button" value="beamen" name="B_TROOP_TRANSFER" id="ttransfer_button" />
          <input type="button" class="button" value="max"
            onclick="$('ttransfer_value').value = '${MAXIMUM}'; $('ttransfer_button').click()" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="show_torpedo_transfer">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value target/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />

    <tal:block tal:condition="IS_UNLOAD">
      <input type="hidden" name="isUnload" tal:attributes="value IS_UNLOAD" />
    </tal:block>
    <table class="tcal">
      <tr>
        <td>Ziel: <span tal:replace="structure bbcode:target/getName">...</span></td>
      </tr>
      <tr>
        <td>Verfügbare Torpedos: ${MAXIMUM}</td>
      </tr>
      <tr>
        <td>
          <img tal:condition="IS_UNLOAD" src="assets/buttons/btorp_down1.png" title="Torpedos hinbeamen" />
          <img tal:condition="not:IS_UNLOAD" src="assets/buttons/btorp_up1.png" title="Torpedos wegbeamen" />
          <input type="text" size="4" name="tcount" id="torptransfer_value" />
          <input type="submit" class="button" value="beamen" name="B_TORPEDO_TRANSFER" id="torptransfer_button" />
          <input type="button" class="button" value="max"
            onclick="$('torptransfer_value').value = '${MAXIMUM}'; $('torptransfer_button').click()" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="selfdestruct">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="sstr" value="runtime" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td colspan="2">Tippe folgenden Code in das Feld um die Selbstzerstörung zu bestätigen.</td>
      </tr>
      <tr>
        <td tal:content="SELF_DESTRUCT_CODE" style="text-align: center; color: Red;">CODE</td>
        <td>
          <input type="text" size="8" name="destructioncode" />
        </td>
      </tr>
      <tr>
        <td colspan="2">
          <input type="submit" class="button" name="B_SELFDESTRUCT" value="Bestätigen" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="show_ship_scan">
  <metal:block tal:condition="THIS/getInformation" metal:use-macro="html/sitemacros.xhtml/systeminformation" />
  <table class="tcal" tal:condition="php:SHIP.isMatrixScannerHealthy() AND NOT SHIP.getCloakState()">
    <tr>
      <th colspan="2">Details</th>
    </tr>
    <tr>
      <td>Lebenszeichen</td>
      <td>${targetShip/getCrewCount}</td>
    </tr>
    <tr>
      <td>Alarmstufe</td>
      <td style="text-align: center;">
        <img src="assets/buttons/alert${targetShip/getAlertState}_1.png" title="Alarmstufe" />
      </td>
    </tr>
    <tr>
      <td>Energie</td>
      <td>${targetShip/getEps}</td>
    </tr>
    <tr tal:condition="targetShip/getBuildplan">
      <td>verbaute Module</td>
      <td><img tal:repeat="mod targetShip/getModules" style="margin-right: 5px;"
          src="assets/goods/${mod/getGoodId}.png" /></td>
    </tr>
  </table>
  <br />
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <br />
    <table class="tcal" tal:condition="not:targetShip/getRump/isTrumfield">
      <tr>
        <th>Systemzustand</th>
      </tr>
      <tr>
        <td style="width: 450px;">
          <div style="float: left; width: 150px;" tal:repeat="data targetShip/getSystems">
            <img title="${data/getName}" class="${data/getCssClass}" src="assets/system/${data/getSystemType}.png" />
            ${data/getStatus}%
          </div>
        </td>
      </tr>
    </table>
    <table class="tcal" tal:condition="targetShip/hasEscapePods">
      <tr>
        <th>Rettungskapseln</th>
      </tr>
      <tr>
        <td style="width: 450px;">
          <span>Es befinden sich <span tal:replace="targetShip/getCrewCount" /> Crewman in den
            Rettungskapseln</span><br /><br />
          <input type="hidden" name="target" tal:attributes="value targetShip/getId" />
          <input type="submit" style="cursor: pointer;" name="B_SALVAGE_EPODS" value="Rettungskapseln bergen" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:macro metal:define-macro="crewslot">
  <div id="rn_crew_${CREW/getId}" tal:condition="not:php: CREW.getUser().getId() EQ SHIP.getUser().getId()">
    <div tal:content="CREW/getName" style="font-weight: bold;">NAME</div>
  </div>
  <div id="rn_crew_${CREW/getId}" tal:condition="php: CREW.getUser().getId() EQ SHIP.getUser().getId()">
    <div onclick="showRenameCrew(this,${CREW/getId});" tal:content="CREW/getName" class="action"
      style="font-weight: bold;">NAME</div>
    <div id="rn_crew_${CREW/getId}_input" style="display: none;">
      <input type="text" size="15" tal:attributes="value CREW/getName" id="rn_crew_${CREW/getId}_value"
        name="rn_crew_${CREW/getId}_value" />
      <input type="button" class="button" value="Ok" onclick="renameCrew(${CREW/getId})" />
    </div>
  </div>
</metal:macro>
<metal:block metal:define-macro="shipdetails">
  <br />
  <div style="width: 100%">
    <div style="width: 33%; float: left;">
      <table class="tcal">
        <tr>
          <th style="width: 20px; text-align: center;">
            <img src="assets/buttons/modul_1.png" />
          </th>
          <td style="vertical-align: middle; text-align: center;">
            <span tal:replace="structure SHIP/getHullStatusBar">EPS</span>
          </td>
          <td style="text-align: center; width: 60px;">
            ${SHIP/getHuell}
          </td>
        </tr>
      </table>
    </div>
    <div style="width: 33%; float: left;">
      <table class="tcal">
        <tr>
          <th style="width: 20px; text-align: center;">
            <img src="assets/buttons/modul_2.png" />
          </th>
          <td style="text-align: center; vertical-align: middle;">
            <span tal:replace="structure SHIP/getShieldStatusBar">SCHILDE</span>
          </td>
          <td style="text-align: center; width: 60px;">
            ${SHIP/getShield}
          </td>
        </tr>
      </table>
    </div>
    <div style="width: 33%; float: left;">
      <table class="tcal">
        <tr>
          <th style="text-align: center; width: 20px;">
            <img src="assets/buttons/modul_8.png" />
          </th>
          <td style="vertical-align: middle; text-align: center;">
            <span tal:replace="structure SHIP/getEpsStatusBar">EPS</span>
          </td>
          <td style="text-align: center; width: 60px;">
            ${SHIP/getEps}
          </td>
        </tr>
      </table>
    </div>
  </div>
  <br style="clear: both;" />
  <br />
  <div style="float: left; width: 350px">
    <table class="tcal">
      <tr>
        <th colspan="4">Crew</th>
      </tr>
      <tr>
        <td colspan="3" class="darkbg">Minimal-Crew</td>
        <td class="darkbg"><span tal:condition="SHIP/getBuildplan"
            tal:replace="SHIP/getBuildplan/getCrew">CREW</span><span tal:condition="not:SHIP/getBuildplan">kA</span>
        </td>
      </tr>
      <tr>
        <td class="darkbg"></td>
        <td class="darkbg"><strong>Position</strong></td>
        <td class="darkbg"><strong>Name</strong></td>
        <td class="darkbg"><strong>Rang</strong></td>
      </tr>
      <tr tal:repeat="data SHIP/getCrewlist">
        <td>
          <img
            src="assets/crew/${data/getCrew/getRace/getGfxPath}/${data/getCrew/getGenderShort}/1_${data/getCrew/getType}.png" />
          <a tal:condition="data/isForeigner"
            href="?B_DUMP_CREWMAN=1&id=${SHIP/getId}&scid=${data/getId}&sstr=${THIS/getSessionString}"
            onmouseover="cp('dump_${data/getId}','buttons/x2')" onmouseout="cp('dump_${data/getId}','buttons/x1')">
            <img src="/assets/buttons/x2.png" name="dump_${data/getId}" title="Crewman entfernen" />
          </a>
        </td>
        <td>
          <div tal:content="data/getPosition">POSITION</div>
        </td>
        <td style="vertical-align: middle;">
          <metal:macro metal:use-macro="crewslot" tal:define="CREW data/getCrew" />
        </td>
        <td>
          <div tal:content="data/getCrew/getTypeDescription">RANG</div>
        </td>
      </tr>
    </table>
  </div>
  <div style="padding-left: 5px; float: left; width: 205px">
    <div class="divhead">Informationen</div>
    <div class="divbody">
      <span>Ersatzbatterie:</span> ${SHIP/getEBatt}<br />
      <span>Trefferchance (eff.):</span> ${SHIP/getHitChance}%<br />
      <span>Ausweichchance (eff.):</span> ${SHIP/getEvadeChance}%<br />
      <span>Schildregeneration:</span> ${SHIP/getShieldRegenerationRate}<br />
      <span>Reaktorleistung:</span> ${SHIP/getReactorOutput}<br />
      <span>Sensorreichtweite:</span> ${SHIP/getSensorRange}<br />
      <tal:block tal:condition="SHIP/canMove">
        <span>Flugkosten</span>: ${SHIP/getRump/getFlightEcost}<br />
      </tal:block>
      <span>Beam-Faktor</span>: ${SHIP/getRump/getBeamFactor}<br />
      <span>Energiewaffensalven</span>: ${SHIP/getRump/getPhaserVolleys}<br />
      <span>Torpedolevel</span>: ${SHIP/getRump/getTorpedoLevel}<br />
      <span>Torpedosalven</span>: ${SHIP/getRump/getTorpedoVolleys}<br />
      <span>Torpedokapazität</span>: ${SHIP/getMaxTorpedos}<br />
      <tal:block tal:condition="SHIP/isBase">
        <span>Dockplätze</span>: ${SHIP/getRump/getDockingSlots}<br />
      </tal:block>
    </div>
    <br />
    <div class="divhead">Systemstatus</div>
    <div class="divbody">
      <div tal:repeat="data SHIP/getSystems">
        <img title="${data/getName}" class="${data/getCssClass}" src="assets/system/${data/getSystemType}.png" />
        ${data/getStatus}%
      </div>
    </div>
  </div>
</metal:block>
<metal:macro metal:define-macro="trademenu">
  <div id="trademenucontent" style="width: 400px;">
    <tal:block tal:condition="THIS/getInformation">
      <br />
      <metal:macro metal:use-macro="html/sitemacros.xhtml/systeminformation" />
    </tal:block>
    <tal:block tal:condition="HAS_LICENSE">
      <form method="post" action="ship.php">
        <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
        <input type="hidden" name="postid" tal:attributes="value TRADEPOST/getId" />
        <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
        <br />
        <table class="tcal">
          <tr>
            <th style="width: 50%;">Warenkonto</th>
            <th>Schiff</th>
          </tr>
          <tr>
            <td>
              <img src="assets/buttons/lager.png" />
              <span tal:replace="TRADEPOST/getStorageSum">SUM</span>/<span
                tal:replace="TRADEPOST/getStorageCapacity">MAX</span>
            </td>
            <td>
              <img src="assets/buttons/lager.png" />
              <span tal:replace="SHIP/getStorageSum">SUM</span>/<span tal:replace="SHIP/getRump/getStorage">MAX</span>
            </td>
          </tr>
        </table>
        <br />
        <table class="tcal">
          <tr>
            <th>Modus</th>
          </tr>
          <tr>
            <td style="width: 50%" class="selected" id="transfertoaccount">
              <a style="display: block;" href="javascript:void(0);"
                onclick="switchTransferToAccount(${TRADEPOST/getId})">Transfer in Konto</a>
            </td>
            <td style="width: 50%" id="transferfromaccount">
              <a style="display: block;" href="javascript:void(0);"
                onclick="switchTransferFromAccount(${TRADEPOST/getId})">Transfer von Konto</a>
            </td>
          </tr>
        </table>

        <div id="trademenutransfer">
          <metal:macro metal:define-macro="transfertoaccount">
            <br />
            <input type="hidden" name="B_TRANSFER_TO_ACCOUNT" value="1" />
            <table class="tcal">
              <tr>
                <th>Waren auf dem Schiff</th>
              </tr>
              <tr>
                <td>
                  <tal:block tal:condition="SHIP/getBeamableStorage" tal:repeat="good SHIP/getBeamableStorage">
                    <input type="hidden" name="goods[]" tal:attributes="value good/getCommodity/getId" />
                    <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
                      <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                        tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
                    </div>
                    <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
                      <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                        tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
                    </div>
                    <br tal:condition="repeat/good/odd" style="clear: both;" />
                  </tal:block>
                  <tal:block tal:condition="not:SHIP/getBeamableStorage">
                    Keine Waren vorhanden
                  </tal:block>
                </td>
              </tr>
            </table>
          </metal:macro>
          <metal:macro metal:define-macro="transferfromaccount">
            <br />
            <input type="hidden" name="B_TRANSFER_FROM_ACCOUNT" value="1" />
            <table class="tcal">
              <tr>
                <th>Waren im Konto</th>
              </tr>
              <tr>
                <td tal:define="storage TRADEPOST/getStorage">
                  <tal:block tal:condition="storage" tal:repeat="good storage">
                    <input type="hidden" name="goods[]" tal:attributes="value good/getGoodId" />
                    <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
                      <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                        tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
                    </div>
                    <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
                      <metal:macro metal:use-macro="macros.xhtml/commoditySelection"
                        tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount" />
                    </div>
                    <br tal:condition="repeat/good/odd" style="clear: both;" />
                  </tal:block>
                  <tal:block tal:condition="not:storage">
                    Keine Waren vorhanden
                  </tal:block>
                </td>
              </tr>
            </table>
          </metal:macro>
          <metal:macro metal:use-macro="transfertoaccount" />
        </div>
        <br />
        <div style="width: 100%; text-align: center;">
          <input type="submit" class="button" value="Transferieren" />
        </div>
      </form>
    </tal:block>
    <tal:block tal:condition="not:HAS_LICENSE">
      <table class="tcal">
        <tr>
          <td tal:content="structure nl2br:TRADEPOST/getTradePostDescription">DESCRIPTION</td>
        </tr>
      </table>
      <br />
      <table class="tcal" tal:condition="CAN_BUY_LICENSE">
        <tr>
          <th>Lizenz erwerben</th>
        </tr>
        <tr>
          <td>
            Um an diesem Posten Handel betreiben zu können ist eine Lizenz nötig. Die einmalige Gebühr dafür beträgt:
            <span tal:replace="TRADEPOST/getTradeLicenseCosts">COST</span> <span
              tal:replace="TRADEPOST/getTradeLicenseCostsCommodity/getName">GOOD</span><br /><br />
            Diese Gebühr kann entweder über ein bereits bestehendes Warenkonto an einem anderen Posten oder aus dem
            Frachtraum des Schiffes beglichen werden.<br /><br />
            <input class="button" type="button" value="Bezahlmethode wählen"
              onclick="tradeMenuChoosePayment(${TRADEPOST/getId});" />

          </td>
        </tr>
      </table>
      <table class="tcal" tal:condition="not:CAN_BUY_LICENSE">
        <tr>
          <th>Lizenzerwerb nicht möglich</th>
        </tr>
        <tr>
          <td>
            Du hast bereits die Maximalzahl an Handelslizenzen (<span
              tal:replace="php:MAX_TRADELICENCE_COUNT">MAXCOUNT</span>) und kannst daher keine weitere erwerben.
          </td>
        </tr>
      </table>
    </tal:block>
  </div>
</metal:macro>
<metal:macro metal:define-macro="trademenupayment">
  <table class="tcal">
    <tr>
      <td>
        Es werden nur angedockte Schiffe/Konten aufgelistet auf denen genug Waren vorhanden sind um die Gebühr zu
        begleichen.<br /><br />
        <img src="assets/goods/${TRADEPOST/getTradeLicenseCostsCommodity/getId}.png"
          tal:attributes="title TRADEPOST/getTradeLicenseCostsCommodity/getName" /> <span
          tal:replace="TRADEPOST/getTradeLicenseCosts">COST</span>
      </td>
    </tr>
  </table>
  <br /><br />
  <input type="hidden" name="sstrajax" id="sstrajax" tal:attributes="value THIS/getSessionString" />
  <table class="tcal">
    <tr>
      <th>Bezahlmethode wählen</th>
    </tr>
    <tr>
      <td>
        <div style="float: left; width: 190px;">
          <strong>Angedockte Schiffe</strong>
          <div tal:repeat="ship DOCKED_SHIPS_FOR_LICENSE">
            - <a href="javascript:void(0);" onclick="payTradeLicence(${TRADEPOST/getId},'ship',${ship/getId})"
              tal:content="structure bbcode:ship/getName">NAME</a>
          </div>
        </div>
        <div style="padding-left: 6px; float: right; width: 190px;">
          <strong>Warenkonten</strong>
          <div tal:repeat="acc ACCOUNTS_FOR_LICENSE">
            - <a href="javascript:void(0);"
              onclick="payTradeLicence(${TRADEPOST/getId},'account',${acc/getTradePostId})"
              tal:content="structure acc/getTradePost/getName">NAME</a>
          </div>
        </div>
      </td>
    </tr>
  </table>
</metal:macro>
<metal:macro metal:define-macro="regioninfo">
  <tal:block tal:condition="THIS/getInformation">
    <br />
    <metal:macro metal:use-macro="html/sitemacros.xhtml/systeminformation" />
  </tal:block>
  <metal:macro metal:use-macro="html/databasemacros.xhtml/regioninfo" />
</metal:macro>
<metal:macro metal:define-macro="sectorscan">
  <tal:block tal:condition="THIS/getInformation">
    <br />
    <metal:macro metal:use-macro="html/sitemacros.xhtml/systeminformation" />
  </tal:block>
  <br />
  <tal:block tal:condition="not:ERROR">
    <table class="tcal">
      <tr>
        <td rowspan="2" style="width: 30px; vertical-align: top;">
          <img src="assets/map/${SHIP/getCurrentMapField/getFieldId}.png" />
        </td>
        <th tal:content="SHIP/getCurrentMapField/getFieldType/getName">NAME</th>
      </tr>
      <tr>
        <td>
          Energiekosten: ${SHIP/getCurrentMapField/getFieldType/getEnergyCosts}<br />
          Schaden: ${SHIP/getCurrentMapField/getFieldType/getSpecialDamage}
          (${SHIP/getCurrentMapField/getFieldType/getDamage})
        </td>
      </tr>
    </table>
    <table class="tcal" tal:condition="SIGNATURES">
      <tr>
        <th colspan="3">Signaturen</th>
      </tr>
      <tr>
        <th>Rumpf</th>
        <th>Schiffsname</th>
        <th>Alter</th>
      </tr>
      <tr tal:repeat="sig SIGNATURES">
        <td>
          <img tal:condition="sig/getRump" src="assets/ships/${sig/getRump/getId}.png"
            tal:attributes="title sig/getRump/getName" />
          <span tal:condition="not:sig/getRump">?</span>
        </td>
        <td>
          <span tal:condition="sig/getShipName" tal:content="structure bbcode:sig/getShipName">.</span>
          <span tal:condition="not:sig/getShipName">?</span>
        </td>
        <td>
          <span tal:content="sig/getAge">.</span>
        </td>
      </tr>
    </table>
    <table class="tcal" tal:condition="php: OTHER_SIG_COUNT OR OTHER_CLOAKED_COUNT">
      <tr>
        <th colspan="2">verblasste Signaturen</th>
      </tr>
      <tr tal:condition="OTHER_SIG_COUNT">
        <td>
          ungetarnt:
        </td>
        <td>
          <span tal:content="OTHER_SIG_COUNT">.</span>
        </td>
      </tr>
      <tr tal:condition="OTHER_CLOAKED_COUNT">
        <td>
          getarnt:
        </td>
        <td>
          <span tal:content="OTHER_CLOAKED_COUNT">.</span>
        </td>
      </tr>
    </table>
  </tal:block>
</metal:macro>
<metal:macro metal:define-macro="repairoptions">
  <tal:block tal:condition="THIS/getInformation">
    <br />
    <metal:macro metal:use-macro="html/sitemacros.xhtml/systeminformation" />
  </tal:block>
  <br />
  <tal:block tal:condition="not:ERROR">
    <form id="selfrepair_form" method="post" action="ship.php">
      <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
      <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
      <table class="tcal">
        <tr>
          <th>Beschädigtes System <img title="Durch die Crew reparierbare Systeme" src="assets/buttons/info2.png"
              style="height:16px;" /></th>
          <th>Anzahl Ingenieure <img title="Die Anzahl Ingenieure beschleunigt die Reparatur"
              src="assets/buttons/info2.png" style="height:16px;" /></th>
          <th>Verwendete Teile <img title="Umfang der Reparatur" src="assets/buttons/info2.png" style="height:16px;" />
          </th>
          <th>Sofortreparatur <img title="Erfordert die dreifache Menge an Teilen" src="assets/buttons/info2.png"
              style="height:16px;" /></th>
        </tr>
        <tr>
          <td>
            <select name="sid" id="systemSelect" style="width:100%;">
              <tal:block tal:repeat="data REPAIR_OPTIONS">
                <option tal:attributes="value data/getSystemType;"><span tal:replace="data/getName">NAME</span>,
                  aktuell: <span tal:replace="data/getStatus">STATUS</span>%</option>
              </tal:block>
            </select>
          </td>
          <td>
            <span tal:replace="ENGINEER_COUNT"></span>
          </td>
          <td>
            <label>
              <input type="radio" name="partschoice" value="1" /> nur
              Ersatzteile (~ auf <span tal:replace="SPARE_PARTS_ONLY">PERCENTAGE</span>%)</label>
            <br />
            <label>
              <input type="radio" name="partschoice" value="2" /> nur
              Systemkomponenten (~ auf <span tal:replace="SYSTEM_COMPONENTS_ONLY">PERCENTAGE</span>%)</label>
            <br />
            <label>
              <input type="radio" name="partschoice" value="3" />
              beides (~ auf <span tal:replace="BOTH">PERCENTAGE</span>%)</label>
          </td>
          <td>
            <input type="checkbox" name="instantrepair" /> sofort
          </td>
        </tr>
        <tr>
          <td colspan="4"><input type="submit" class="button" value="Reparatur starten" name="B_SELF_REPAIR"
              id="selfrepair_button" /></td>
        </tr>
      </table>
    </form>
  </tal:block>
</metal:macro>
<metal:macro metal:define-macro="astroentry">
  <table class="tcal">
    <tr tal:condition="ENTRY/getStarsystemMap1">
      <td>
        <span>(${ENTRY/getStarsystemMap1/getSx}|${ENTRY/getStarsystemMap1/getSy})</span>
      </td>
    </tr>
    <tr tal:condition="ENTRY/getStarsystemMap2">
      <td>
        <span>(${ENTRY/getStarsystemMap2/getSx}|${ENTRY/getStarsystemMap2/getSy})</span>
      </td>
    </tr>
    <tr tal:condition="ENTRY/getStarsystemMap3">
      <td>
        <span>(${ENTRY/getStarsystemMap3/getSx}|${ENTRY/getStarsystemMap3/getSy})</span>
      </td>
    </tr>
    <tr tal:condition="ENTRY/getStarsystemMap4">
      <td>
        <span>(${ENTRY/getStarsystemMap4/getSx}|${ENTRY/getStarsystemMap4/getSy})</span>
      </td>
    </tr>
    <tr tal:condition="ENTRY/getStarsystemMap5">
      <td>
        <span>(${ENTRY/getStarsystemMap5/getSx}|${ENTRY/getStarsystemMap5/getSy})</span>
      </td>
    </tr>
  </table>
</metal:macro>
<metal:macro metal:define-macro="colonization">
  <div tal:attributes="class COLONY_SURFACE/getSurfaceTileCssClass" tal:define="sstr THIS/getSessionString">
    <tal:block tal:repeat="field COLONY_SURFACE/getSurface">
      <div style="width: 40px; height: 40px;" tal:attributes="class field/getCssClass">
        <div>
          <div>
            <img tal:condition="not:field/isColonizeAble" style="width: 40px; height: 40px;" title="runtime"
              tal:attributes="title field/getTitleString" src="assets/generated/fields/${field/getFieldType}.png" />
            <a tal:condition="field/isColonizeAble"
              href="?id=${SHIP/getId}&B_COLONIZE=1&colid=${currentColony/getId}&field=${field/getId}&sstr=${sstr}">
              <img style="width: 40px; height: 40px;" title="runtime" tal:attributes="title field/getTitleString"
                src="assets/generated/fields/${field/getFieldType}.png" />
            </a>
          </div>
        </div>
      </div>
    </tal:block>
  </div>
  <tal:block tal:condition="currentColony/getPlanetType/getColonizeableFields">
    <br />
    <div class="divhead">Kolonisierbare Felder</div>
    <div class="divbody">
      <img src="assets/generated/fields/${field}.png"
        tal:repeat="field currentColony/getPlanetType/getColonizeableFields" />
    </div>
  </tal:block>
</metal:macro>
<metal:macro metal:define-macro="colonyscan">
  <tal:block tal:condition="THIS/getInformation">
    <br />
    <metal:macro metal:use-macro="html/sitemacros.xhtml/systeminformation" />
  </tal:block>
  <br />
  <tal:block tal:condition="not:ERROR" tal:define="style string:margin: 1px;; width: 42px;; height: 42px;;">
    <div tal:attributes="class COLONY_SURFACE/getSurfaceTileCssClass" tal:define="sstr THIS/getSessionString">
      <tal:block tal:repeat="field COLONY_SURFACE/getSurface">
        <tal:block tal:condition="not:field/hasBuilding">
          <div tal:condition="not:field/getTerraforming" style="${style}" tal:attributes="class field/getCssClass">
            <div style="width: 40px; height: 40px;" id="field${field/getFieldId}">
              <div>
                <div>
                  <img style="width: 40px; height: 40px;" tal:attributes="title field/getTitleString"
                    src="assets/generated/fields/${field/getFieldType}.png" />
                </div>
              </div>
            </div>
          </div>
          <div tal:condition="field/getTerraforming" style="${style};" tal:attributes="class field/getCssClass">
            <div
              style="background-image: url(assets/generated/fields/${field/getFieldType}.png); width: 40px; height: 40px;"
              id="field${field/getFieldId}">
              <div>
                <div>
                  <img class="action" style="width: 40px; height: 40px;" title="runtime"
                    tal:attributes="title field/getTitleString"
                    src="assets/terraform/${field/getTerraforming/getId}/${COLONY_SURFACE/getDayNightState}.png" />
                </div>
              </div>
            </div>
          </div>
        </tal:block>
        <tal:block tal:condition="field/hasBuilding">
          <div tal:condition="not:field/isInConstruction" style="${style}" tal:attributes="class field/getCssClass">
            <div
              style="background-image: url(assets/generated/fields/${field/getFieldType}.png); width: 40px; height: 40px;"
              id="field${field/getFieldId}">
              <div>
                <div>
                  <a
                    href="?id=${SHIP/getId}&B_ATTACK_BUILDING=1&colid=${currentColony/getId}&field=${field/getId}&sstr=${sstr}">
                    <img style="width: 40px; height: 40px;" title="Gebäude bombardieren: ${field/getTitleString}"
                      src="assets/generated/buildings/${field/getBuildingId}/${field/getBuilding/getBuildingType}${field/getBuildingState}${COLONY_SURFACE/getDayNightState}.png" />
                  </a>
                </div>
              </div>
            </div>
          </div>
          <div tal:condition="field/isInConstruction" style="${style}" tal:attributes="class field/getCssClass">
            <div
              style="background-image: url(assets/generated/fields/${field/getFieldType}.png); width: 40px; height: 40px;"
              id="field${field/getFieldId}">
              <div
                style="width: 40px; height: 40px; background-image: url(assets/generated/buildings/${field/getPictureType}${COLONY_SURFACE/getDayNightState}.png)">
                <div style="height: 40px; overflow: hidden; width: ${field/getOverlayWidth}px;"><img
                    style="width: 40px; height: 40px;" tal:attributes="title field/getTitleString"
                    src="assets/generated/buildings/${field/getBuildingId}/${field/getBuilding/getBuildingType}a${COLONY_SURFACE/getDayNightState}.png" />
                </div>
              </div>
            </div>
          </div>
        </tal:block>
      </tal:block>
    </div>
  </tal:block>
</metal:macro>

</html>
