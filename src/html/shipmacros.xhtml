<html xmlns:stu="stu">
<metal:macro metal:define-macro="shiplist_header">
  <tr>
    <th style="width: 140px;">Klasse</th>
    <th>Name</th>
    <th style="width: 22px;"></th>
    <th style="width: 70px;">x|y</th>
    <th style="width: 100px;">Hülle</th>
    <th style="width: 120px;">Schilde</th>
    <th style="width: 120px;">Energie</th>
    <th style="width: 120px;">Versorgung</th>
    <th style="width: 90px; text-align: center;">Crew</th>
    <th style="width: 100px; text-align: center;">Systeme</th>
    <th style="width: 35px;"></th>
  </tr>
</metal:macro>
<metal:macro metal:define-macro="shiplist_body">
  <tr tal:attributes="class string:row${repeat/ship/odd}">
    <td style="background-color: #000000 ! important">
      <a href="ship.php?SHOW_SHIP=1&id=${ship/getId}"><metal:macro metal:use-macro="shipimage" /></a>
    </td>
    <td>
      <a href="ship.php?SHOW_SHIP=1&id=${ship/getId}" tal:content="structure bbcode:ship/getName">.</a>
    </td>
    <td style="text-align: center;">
      <img src="assets/buttons/alert${ship/getAlertState}.gif" title="Alarmstufe" />
    </td>
    <td>
      ${ship/getPosX}|${ship/getPosY}
    </td>
    <td>
      ${ship/getHuell}/${ship/getMaxHuell}
    </td>
    <td>
      <span tal:condition="ship/getShieldState" class="activeshield" tal:content="string:${ship/getShield}/${ship/getMaxShield}">..</span>
      <span tal:condition="not:ship/getShieldState">${ship/getShield}/${ship/getMaxShield}</span>
      (+<span tal:replace="ship/getShieldRegenerationRate">REGENERATIONRATE</span>)
    </td>
    <td>
      ${ship/getEps}/${ship/getMaxEps}
      <span>${addPlusCharacter:ship/getEffectiveEpsProduction}</span>
      (<span tal:content="ship/getEpsUsage" class="neg">USAGE</span>/<span class="neg" tal:content="ship/getWarpcoreUsage">CORE</span>)
    </td>
    <td>
      <div style="float: left; width: 50%">
        <img src="assets/buttons/warpk.gif" title="Warpkern" /> <span tal:replace="ship/getWarpcoreLoad">Warpcore</span>
      </div>
      <div style="float: left; width: 50%">
        <img src="assets/buttons/batt.gif" title="Ersatzbatterie" /> <span tal:replace="ship/getEBatt">BATTERY</span>
      </div>
    </td>
    <td tal:content="ship/getCrewCount" style="text-align: center;">CREW</td>
    <td>
      <img src="assets/buttons/kss2.gif" tal:condition="ship/getNbs" title="Nahbereichssensoren aktiviert" />
      <img src="assets/buttons/kss1.gif" tal:condition="not:ship/getNbs" title="Nahbereichssensoren deaktiviert" />
      <img src="assets/buttons/lss2.gif" tal:condition="ship/getLss" title="Langstreckensensoren aktiviert" />
      <img src="assets/buttons/lss1.gif" tal:condition="not:ship/getLss" title="Langstreckensensoren deaktiviert" />
      <img src="assets/buttons/act_phaser2.gif" tal:condition="ship/getPhaser" title="Strahlenwaffe aktiviert" />
      <img src="assets/buttons/act_phaser1.gif" tal:condition="not:ship/getPhaser" title="Strahlenwaffe deaktiviert" />
      <img src="assets/buttons/act_torp2.gif" tal:condition="ship/getTorpedos" title="Torpedobänke aktiviert" />
      <img src="assets/buttons/act_torp1.gif" tal:condition="not:ship/getTorpedos" title="Torpedobände deaktiviert" />
      <tal:block tal:condition="ship/isCloakAble">
        <img src="assets/buttons/tarn2.gif" tal:condition="ship/getCloakState" title="Tarnung aktiviert" />
        <img src="assets/buttons/tarn1.gif" tal:condition="not:ship/getCloakState" title="Tarnung deaktiviert" />
      </tal:block>
    </td>
    <td style="text-align: center;">
      <tal:block tal:condition="ship/getFleet">
        <a href="?B_DELETE_FLEET=1&id=${ship/getId}&sstr=${THIS/getSessionString}" tal:condition="ship/isFleetLeader" onmouseover="cp('fleet_${ship/getId}','buttons/fl_flag3')" onmouseout="cp('fleet_${ship/getId}','buttons/fl_flag2')">
          <img src="assets/buttons/fl_flag2.gif" name="fleet_${ship/getId}" title="Flotte auflösen" />
        </a>
        <a href="?B_LEAVE_FLEET=1&id=${ship/getId}&sstr=${THIS/getSessionString}" tal:condition="not:ship/isFleetLeader" onmouseover="cp('fleet_${ship/getId}','buttons/fl_raus2')" onmouseout="cp('fleet_${ship/getId}','buttons/fl_raus1')">
          <img src="assets/buttons/fl_raus1.gif" name="fleet_${ship/getId}" title="Flotte verlassen" />
        </a>
      </tal:block>
      <tal:block tal:condition="not:ship/getFleet">
        <a href="?B_NEW_FLEET=1&id=${ship/getId}" tal:condition="not:ship/isBase" onmouseover="cp('fleet_${ship/getId}','buttons/fl_flag2')" onmouseout="cp('fleet_${ship/getId}','buttons/fl_flag1')">
          <img src="assets/buttons/fl_flag1.gif" name="fleet_${ship/getId}" title="Flotte erstellen" />
        </a>
      </tal:block>
    </td>
  </tr>
</metal:macro>
<metal:macro metal:define-macro="shipimage">
  <img src="assets/ships/${ship/getRump/getId}.gif" tal:attributes="title ship/getRump/getName" />
</metal:macro>
<metal:macro metal:define-macro="hiddenshipid" phptal:cache="1m per SHIP/getId">
  <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
</metal:macro>
<metal:block metal:define-macro="nbslist_header">
  <tr>
    <td class="darkbg" style="font-weight: bold; width: 60px;" colspan="2">Aktionen</td>
    <td class="darkbg"></td>
    <td class="darkbg" style="font-weight: bold;">Name</td>
    <td class="darkbg" style="font-weight: bold;">Zustand</td>
    <td class="darkbg" style="font-weight: bold;">Siedler</td>
  </tr>
</metal:block>
<metal:block metal:define-macro="nbslist_body">
  <tal:block tal:condition="SHIP/displayNbsActions" tal:define="sstr string:${THIS/getSessionString}; nameWithoutMarkup bbcode2txt:ship/getName">
    <td style="width: 30px; text-align: center;">
      <tal:block tal:condition="SHIP/canAttack">
        <div tal:condition="ship/canBeAttacked" style="cursor: pointer;" onClick="$('nbsf_${ship/getId}').submit();" onmouseover="cp('att_${ship/getId}','buttons/phaser2')" onmouseout="cp('att_${ship/getId}','buttons/phaser1')">
          <img src="assets/buttons/phaser1.gif" name="att_${ship/getId}" title="${nameWithoutMarkup} angreifen" />
        </div>
      </tal:block>
    </td>
    <td style="width: 120px;">
      <a href="javascript:void(0);" onclick="showScanWindow(${SHIP/getId},${ship/getId})" onmouseover="cp('scn_${ship/getId}','buttons/lupe2')" onmouseout="cp('scn_${ship/getId}','buttons/lupe1')">
        <img src="assets/buttons/lupe1.gif" name="scn_${ship/getId}" title="${nameWithoutMarkup} scannen" />
      </a>
      <tal:block tal:condition="SHIP/canIntercept">
        <a tal:condition="ship/isInterceptable" href="?B_INTERCEPT=1&id=${SHIP/getId}&target=${ship/getId}&sstr=${THIS/getSessionString}" onmouseover="cp('int_${ship/getId}','buttons/inc2')" onmouseout="cp('int_${ship/getId}','buttons/inc1')">
          <img src="assets/buttons/inc1.gif" name="int_${ship/getId}" title="${nameWithoutMarkup} abfangen" />
        </a>
      </tal:block>
      <tal:block tal:condition="not:ship/getWarpState">
        <a href="javascript:void(0);" tal:condition="not:ship/getIsDestroyed" onclick="showETransferWindow(${ship/getId})" onmouseover="cp('etr_${ship/getId}','buttons/e_trans2')" onmouseout="cp('etr_${ship/getId}','buttons/e_trans1')">
          <img src="assets/buttons/e_trans1.gif" name="etr_${ship/getId}" title="Energie zur ${nameWithoutMarkup} transferieren" />
        </a>
        <a href="javascript:void(0);" onclick="showBToWindow(${ship/getId})" onmouseover="cp('bto_${ship/getId}','buttons/b_down2')" onmouseout="cp('bto_${ship/getId}','buttons/b_down1')">
          <img src="assets/buttons/b_down1.gif" name="bto_${ship/getId}" title="Zur ${nameWithoutMarkup} runterbeamen" />
        </a>
        <a href="javascript:void(0);" onclick="showBFromWindow(${ship/getId})" onmouseover="cp('bfr_${ship/getId}','buttons/b_up2')" onmouseout="cp('bfr_${ship/getId}','buttons/b_up1')">
          <img src="assets/buttons/b_up1.gif" name="bfr_${ship/getId}" title="Von der ${nameWithoutMarkup} hochbeamen" />
        </a>
        <tal:block tal:condition="not:ship/traktorbeamNotPossible">
          <tal:block tal:condition="not:SHIP/isTraktorBeamActive">
            <a href="?B_ACTIVATE_TRAKTOR=1&id=${SHIP/getId}&target=${ship/getId}&sstr=${sstr}" onmouseover="cp('tra_${ship/getId}','buttons/trak2')" onmouseout="cp('tra_${ship/getId}','buttons/trak1')">
              <img src="assets/buttons/trak1.gif" name="tra_${ship/getId}" title="Traktorstrahl auf die ${nameWithoutMarkup} richten" />
            </a>
          </tal:block>
        </tal:block>
        <tal:block tal:condition="ship/isBase">
          <a tal:condition="not:SHIP/getDockedTo" href="?B_DOCK=1&id=${SHIP/getId}&target=${ship/getId}&sstr=${THIS/getSessionString}" onmouseover="cp('dock_${ship/getId}','buttons/dock2')" onmouseout="cp('dock_${ship/getId}','buttons/dock1')">
            <img src="assets/buttons/dock1.gif" name="dock_${ship/getId}" title="An die ${nameWithoutMarkup} andocken" />
          </a>
        </tal:block>
      </tal:block>
      <tal:block tal:condition="ship/getWarpState">
        <span style="width: 100%; color: #474791;">Im Warp</span>
      </tal:block>
    </td>
  </tal:block>
  <tal:block tal:condition="not:SHIP/displayNbsActions">
    <td colspan="2" style="text-align: center;">
      <tal:block tal:condition="SHIP/getWarpState">
        <tal:block tal:condition="SHIP/canIntercept">
          <a tal:condition="ship/isInterceptable" href="?B_INTERCEPT=1&id=${SHIP/getId}&target=${ship/getId}&sstr=${THIS/getSessionString}" onmouseover="cp('int_${ship/getId}','buttons/inc2')" onmouseout="cp('int_${ship/getId}','buttons/inc1')">
            <img src="assets/buttons/inc1.gif" name="int_${ship/getId}" title="${bbcode2txt:ship/getName} abfangen" />
          </a>
        </tal:block>
        <a href="javascript:void(0);" onclick="showScanWindow(${SHIP/getId},${ship/getId})" onmouseover="cp('scn_${ship/getId}','buttons/lupe2')" onmouseout="cp('scn_${ship/getId}','buttons/lupe1')">
          <img src="assets/buttons/lupe1.gif" name="scn_${ship/getId}" title="${bbcode2txt:ship/getName} scannen" />
        </a>
        <span style="width: 100%; color: #474791;">Warpantrieb aktiv</span>
      </tal:block>
      <div style="width: 100%; color: #404040;" tal:condition="SHIP/getCloakState">Tarnung aktiv</div>
    </td>
  </tal:block>
  <td style="width: 200px; background-color: #000000 ! important;">
    <metal:macro metal:use-macro="shipimage" />
  </td>
  <td tal:content="structure bbcode:ship/getName">.</td>
  <tal:block tal:condition="not:ship/getRump/isTrumfield">
    <td style="width: 160px;">
      <span tal:replace="ship/getHuell"></span>/<span tal:replace="ship/getMaxHuell"></span>
      <tal:block tal:condition="ship/getShieldState">
        (<span class="activeshield">${ship/getShield}</span>)
      </tal:block>
    </td>
    <td>
      <a
        href="javascript:void(0);"
        onclick="openPmWindow(${ship/getUserId})"
        title="Nachricht an ${bbcode2txt:ship/getUser/getName} verfassen"
        onmouseover="cp('nbsPm${ship/getId}','buttons/msg2')"
        onmouseout="cp('nbsPm${ship/getId}','buttons/msg1')">
        <img src="/assets/buttons/msg1.gif" name="nbsPm${ship/getId}" /></a>
      <span tal:replace="structure bbcode:ship/getUser/getName">USERNAME</span> (${ship/getUserId})
    </td>
  </tal:block>
  <tal:block tal:condition="ship/getRump/isTrumfield">
    <td style="width: 160px;" tal:content="ship/getHuell">HULL</td>
    <td>
      <span tal:replace="structure bbcode:ship/getUser/getName">USERNAME</span>
    </td>
  </tal:block>
</metal:block>
<metal:block metal:define-macro="initial_js">
  <script language="Javascript">
			var sstr = '${THIS/getSessionString}';
			var shipid = ${SHIP/getId};
		</script>
  <script type="text/javascript" src="${THIS/getJavascriptPath}/js/ship.js"><!-- stuniverse --></script>
</metal:block>
<metal:block metal:define-macro="show_ship_alvl">
  <table style="width: 100%;" tal:define="sstr THIS/getSessionString">
    <tr>
      <td>
        <a href="?B_SET_GREEN_ALERT=1&id=${SHIP/getId}&sstr=${sstr}">
          <img src="assets/buttons/alert1.gif" /> Alarmstufe Grün
        </a>
      </td>
    </tr>
    <tr>
      <td>
        <a href="?B_SET_YELLOW_ALERT=1&id=${SHIP/getId}&sstr=${sstr}">
          <img src="assets/buttons/alert2.gif" /> Alarmstufe Gelb
        </a>
      </td>
    </tr>
    <tr>
      <td>
        <a href="?B_SET_RED_ALERT=1&id=${SHIP/getId}&sstr=${sstr}">
          <img src="assets/buttons/alert3.gif" /> Alarmstufe Rot
        </a>
      </td>
    </tr>
  </table>
</metal:block>
<metal:block metal:define-macro="show_ship_etransfer">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value targetShip/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td>Ziel: <span tal:replace="structure bbcode:targetShip/getName">...</span></td>
      </tr>
      <tr>
        <td>Verfügbare Energie: ${SHIP/getEps}/${SHIP/getMaxEps}</td>
      </tr>
      <tr>
        <td>
          <img src="assets/buttons/e_trans2.gif" title="Energietransfer" />
          <input type="text" size="4" name="ecount" id="etransfer_value" />
          <input type="submit" class="button" value="transferieren" name="B_ETRANSFER" id="etransfer_button" />
          <input type="button" class="button" value="max" name="B_MAX_ETRANSFER"
                 onclick="$('etransfer_value').value = '${SHIP/getEps}'; $('etransfer_button').click()"
          />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="entity_not_available">
  <div class="box">
    <div class="box_body">Das Ziel wurde nicht gefunden</div>
  </div>
</metal:block>
<metal:block metal:define-macro="show_ship_beamto">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value targetShip/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td colspan="2">Ziel: <span tal:replace="structure bbcode:targetShip/getName">...</span></td>
      </tr>
      <tr>
        <td style="width: 100%;">
          <tal:block tal:condition="SHIP/getStorage" tal:repeat="good SHIP/getStorage">
            <input type="hidden" name="goods[]" tal:attributes="value good/getCommodity/getId" />
            <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
              <metal:macro
                metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
              />
            </div>
            <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
              <metal:macro
                metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
              />
            </div>
            <br tal:condition="repeat/good/odd" style="clear: both;" />
          </tal:block>
          <tal:block tal:condition="not:SHIP/getStorage">
            Keine Waren vorhanden
          </tal:block>
        </td>
        <td rowspan="2" style="height: 100%;">
          <table style="width: 100%; height: 100%;">
            <tr>
              <td style="text-align: center;">
                <a href="?SHOW_SHIP=1&id=${SHIP/getId}">
                  <img src="assets/ships/${SHIP/getRump/getId}.gif" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center; height: 10%;">
                <a href="javascript:void(0);" onclick="triggerBeamFrom(${targetShip/getId})" onmouseover="cp('beamtrigger','buttons/b_down2');" onmouseout="cp('beamtrigger','buttons/b_down1');">
                  <img src="assets/buttons/b_down1.gif" name="beamtrigger" title="Beammodus wechseln" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center;">
                <img tal:condition="not:OWNS_TARGET" src="assets/ships/${targetShip/getRump/getId}.gif" />
                <a tal:condition="OWNS_TARGET" href="?SHOW_SHIP=1&id=${targetShip/getId}">
                  <img src="assets/ships/${targetShip/getRump/getId}.gif" />
                </a>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;">
          <input type="submit" class="button" value="Beamen" name="B_BEAMTO" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="show_ship_beamfrom">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value targetShip/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td colspan="2">Ziel: <span tal:replace="structure bbcode:targetShip/getName">...</span></td>
      </tr>
      <tr>
        <td style="width: 100%;">
          <tal:block tal:condition="targetShip/getStorage" tal:repeat="good targetShip/getStorage">
            <input type="hidden" name="goods[]" tal:attributes="value good/getCommodity/getId" />
            <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
              <metal:macro
                metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
              />
            </div>
            <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
              <metal:macro
                metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
              />
            </div>
            <br tal:condition="repeat/good/odd" style="clear: both;" />
          </tal:block>
          <tal:block tal:condition="not:targetShip/getStorage">
            Keine Waren vorhanden
          </tal:block>
        </td>
        <td rowspan="2" style="height: 100%;">
          <table style="width: 100%; height: 100%;">
            <tr>
              <td style="text-align: center;">
                <a href="?SHOW_SHIP=1&id=${SHIP/getId}">
                  <img src="assets/ships/${SHIP/getRump/getId}.gif" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center; height: 10%;">
                <a href="javascript:void(0);" onclick="triggerBeamTo(${targetShip/getId})" onmouseover="cp('beamtrigger','buttons/b_up2');" onmouseout="cp('beamtrigger','buttons/b_up1');">
                  <img src="assets/buttons/b_up1.gif" name="beamtrigger" title="Beammodus wechseln" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center;">
                <img tal:condition="not:OWNS_TARGET" src="assets/ships/${targetShip/getRump/getId}.gif" />
                <a tal:condition="OWNS_TARGET" href="?SHOW_SHIP=1&id=${targetShip/getId}">
                  <img src="assets/ships/${targetShip/getRump/getId}.gif" />
                </a>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;">
          <input type="submit" class="button" value="Beamen" name="B_BEAMFROM" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="show_ship_beamto_colony">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value targetColony/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td colspan="2">Ziel: <span tal:replace="structure bbcode:targetColony/getName">...</span></td>
      </tr>
      <tr>
        <td style="width: 100%;">
          <tal:block tal:condition="SHIP/getStorage" tal:repeat="good SHIP/getStorage">
            <input type="hidden" name="goods[]" tal:attributes="value good/getCommodity/getId" />
            <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
              <metal:macro
                metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
              />
            </div>
            <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
              <metal:macro
                metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
              />
            </div>
            <br tal:condition="repeat/good/odd" style="clear: both;" />
          </tal:block>
          <tal:block tal:condition="not:SHIP/getStorage">
            Keine Waren vorhanden
          </tal:block>
        </td>
        <td rowspan="2" style="height: 100%;">
          <table style="width: 100%; height: 100%;">
            <tr>
              <td style="text-align: center;">
                <a href="?SHOW_SHIP=1&id=${SHIP/getId}">
                  <img src="assets/ships/${SHIP/getRump/getId}.gif" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center; height: 10%;">
                <a href="javascript:void(0);" onclick="triggerBeamFromColony(${targetColony/getId})" onmouseover="cp('beamtrigger','buttons/b_down2');" onmouseout="cp('beamtrigger','buttons/b_down1');">
                  <img src="assets/buttons/b_down1.gif" name="beamtrigger" title="Beammodus wechseln" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center;">
                <img tal:condition="not:OWNS_TARGET" src="assets/planets/${targetColony/getColonyClass}.gif" />
                <a tal:condition="OWNS_TARGET" href="colony.php?SHOW_COLONY=1&id=${targetColony/getId}">
                  <img src="assets/planets/${targetColony/getColonyClass}.gif" />
                </a>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;">
          <input type="submit" class="button" value="Beamen" name="B_BEAMTO_COLONY" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="show_ship_beamfrom_colony">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="target" tal:attributes="value targetColony/getId" />
    <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td colspan="2">Ziel: <span tal:replace="structure bbcode:targetColony/getName">...</span></td>
      </tr>
      <tr>
        <td style="width: 100%;">
          <tal:block tal:condition="targetColony/getStorage" tal:repeat="good targetColony/getBeamableStorage">
            <input type="hidden" name="goods[]" tal:attributes="value good/getGoodId" />
            <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
              <metal:macro
                metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
              />
            </div>
            <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
              <metal:macro
                metal:use-macro="macros.xhtml/commoditySelection"
                tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
              />
            </div>
            <br tal:condition="repeat/good/odd" style="clear: both;" />
          </tal:block>
          <tal:block tal:condition="not:targetColony/getStorage">
            Keine Waren vorhanden
          </tal:block>
        </td>
        <td rowspan="2" style="height: 100%;">
          <table style="width: 100%; height: 100%;">
            <tr>
              <td style="text-align: center;">
                <a href="?SHOW_SHIP=1&id=${SHIP/getId}">
                  <img src="assets/ships/${SHIP/getRump/getId}.gif" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center; height: 10%;">
                <a href="javascript:void(0);" onclick="triggerBeamToColony(${targetColony/getId})" onmouseover="cp('beamtrigger','buttons/b_up2');" onmouseout="cp('beamtrigger','buttons/b_up1');">
                  <img src="assets/buttons/b_up1.gif" name="beamtrigger" title="Beammodus wechseln" />
                </a>
              </td>
            </tr>
            <tr>
              <td style="text-align: center;">
                <img tal:condition="not:OWNS_TARGET" src="assets/planets/${targetColony/getColonyClass}.gif" />
                <a tal:condition="OWNS_TARGET" href="colony.php?SHOW_COLONY=1&id=${targetColony/getId}">
                  <img src="assets/planets/${targetColony/getColonyClass}.gif" />
                </a>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;">
          <input type="submit" class="button" value="Beamen" name="B_BEAMFROM_COLONY" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="selfdestruct">
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <input type="hidden" name="sstr" value="runtime" tal:attributes="value THIS/getSessionString" />
    <table class="tcal">
      <tr>
        <td colspan="2">Tippe folgenden Code in das Feld um die Selbstzerstörung zu bestätigen.</td>
      </tr>
      <tr>
        <td tal:content="SELF_DESTRUCT_CODE" style="text-align: center; color: Red;">CODE</td>
        <td>
          <input type="text" size="8" name="destructioncode" />
        </td>
      </tr>
      <tr>
        <td colspan="2">
          <input type="submit" class="button" name="B_SELFDESTRUCT" value="Bestätigen" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="show_ship_scan">
  <metal:block tal:condition="THIS/getInformation" metal:use-macro="html/sitemacros.xhtml/systeminformation" />
  <form action="ship.php" method="post">
    <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
    <br />
    <table class="tcal" tal:condition="not:targetShip/getRump/isTrumfield">
      <tr>
        <th>Systemzustand</th>
      </tr>
      <tr>
        <td style="width: 450px;">
          <div style="float: left; width: 150px;" tal:repeat="data targetShip/getSystems">
            <img src="assets/system/${data/getSystemType}.gif" />
            ${data/getStatus}%
          </div>
        </td>
      </tr>
    </table>
    <table class="tcal" tal:condition="targetShip/hasEscapePods">
      <tr>
        <th>Rettungskapseln</th>
      </tr>
      <tr>
        <td style="width: 450px;">
          <span>In dem Trümmerfeld befinden sich <span tal:replace="targetShip/getCrewCount"/> Rettungskapseln</span><br /><br />
          <input type="hidden" name="target" tal:attributes="value targetShip/getId" />
          <input type="submit" style="cursor: pointer;" name="B_SALVAGE_EPODS"  value="Rettungskapseln bergen" />
        </td>
      </tr>
    </table>
  </form>
</metal:block>
<metal:block metal:define-macro="shipdetails">
  <br />
  <div style="width: 100%">
    <div style="width: 33%; float: left;">
      <table class="tcal">
        <tr>
          <th style="width: 20px; text-align: center;">
            <img src="assets/buttons/modul_1.gif" />
          </th>
          <td style="vertical-align: middle; text-align: center;">
            <span tal:replace="structure HULL_STATUS_BAR">EPS</span>
          </td>
          <td style="text-align: center; width: 60px;">
            ${SHIP/getHuell}
          </td>
        </tr>
      </table>
    </div>
    <div style="width: 33%; float: left;">
      <table class="tcal">
        <tr>
          <th style="width: 20px; text-align: center;">
            <img src="assets/buttons/modul_2.gif" />
          </th>
          <td style="text-align: center; vertical-align: middle;">
            <span tal:replace="structure SHIELD_STATUS_BAR">SCHILDE</span>
          </td>
          <td style="text-align: center; width: 60px;">
            ${SHIP/getShield}
          </td>
        </tr>
      </table>
    </div>
    <div style="width: 33%; float: left;">
      <table class="tcal">
        <tr>
          <th style="text-align: center; width: 20px;">
            <img src="assets/buttons/modul_8.gif" />
          </th>
          <td style="vertical-align: middle; text-align: center;">
            <span tal:replace="structure EPS_STATUS_BAR">EPS</span>
          </td>
          <td style="text-align: center; width: 60px;">
            ${SHIP/getEps}
          </td>
        </tr>
      </table>
    </div>
  </div>
  <br style="clear: both;" />
  <br />
  <div style="float: left; width: 250px">
    <table class="tcal">
      <tr>
        <th colspan="2">Crew</th>
      </tr>
      <tr>
        <td class="darkbg"></td>
        <td class="darkbg"><strong>Name</strong></td>
      </tr>
      <tr tal:repeat="data SHIP/getCrewlist">
        <td>
          <img src="assets/crew/${data/getCrew/getRace/getGfxPath}/${data/getCrew/getGenderShort}/1_${data/getCrew/getType}.png" />
        </td>
        <td style="vertical-align: middle;">
          <metal:macro metal:define-macro="crewslot">
            <div id="rn_crew_${CREW/getId}">
              <div onclick="showRenameCrew(this,${CREW/getId});" tal:content="CREW/getName" class="action" style="font-weight: bold;">NAME</div>
              <div id="rn_crew_${CREW/getId}_input" style="display: none;">
                <input type="text" size="15" tal:attributes="value CREW/getName" id="rn_crew_${CREW/getId}_value" name="rn_crew_${CREW/getId}_value" />
                <input type="button" class="button" value="Ok" onclick="renameCrew(${CREW/getId})" />
              </div>
            </div>
          </metal:macro>
          <metal:macro metal:use-macro="crewslot" tal:define="CREW data/getCrew" />
          <div tal:content="data/getCrew/getTypeDescription">NAME</div>
        </td>
      </tr>
    </table>
  </div>
  <div style="padding-left: 5px; float: left; width: 205px">
    <div class="divhead">Informationen</div>
    <div class="divbody">
      <span>Ersatzbatterie:</span> ${SHIP/getEBatt}<br />
      <span>Trefferchance (eff.):</span> ${SHIP/getHitChance}%<br />
      <span>Ausweichchance (eff.):</span> ${SHIP/getEvadeChance}%<br />
      <span>Schildregeneration:</span> ${SHIP/getShieldRegenerationRate}<br />
      <span>Reaktorleistung:</span> ${SHIP/getReactorOutput}<br />
      <span>Sensorreichtweite:</span> ${SHIP/getSensorRange}<br />
      <span>Flugkosten</span>: ${SHIP/getRump/getFlightEcost}<br />
      <span>Torpedolagerraum</span>: ${SHIP/getMaxTorpedos}<br />
      <span>Punkte</span>: ${SHIP/getRump/getShipRumpCategory/getPoints}<br />
    </div>
    <br />
    <div class="divhead">Systemstatus</div>
    <div class="divbody">
      <div tal:repeat="data SHIP/getSystems">
        <img src="assets/system/${data/getSystemType}.gif" />
        ${data/getStatus}%
      </div>
    </div>
  </div>
</metal:block>
<metal:block metal:define-macro="dockprivileges">
  <br /><br />
  <div id="dockprivilegelist">
    <metal:macro metal:define-macro="dockprivilegelist">
      <input type="hidden" id="dock_sstr" tal:attributes="value THIS/getSessionString" />
      <table class="tcal" style="width: 400px;">
        <tr>
          <th>Ziel</th>
          <th>Modus</th>
          <th></th>
        </tr>
        <tr tal:repeat="data SHIP/getDockPrivileges">
          <td tal:content="structure bbcode:data/getTargetName">NAME</td>
          <td class="positive" tal:condition="data/isDockingAllowed" tal:content="data/getPrivilegeModeString">MODE</td>
          <td class="negative" tal:condition="not:data/isDockingAllowed" tal:content="data/getPrivilegeModeString">MODE</td>
          <td>
            <div style="cursor: pointer;" onclick="deleteDockPrivilege(${data/getId},'${THIS/getSessionString}')" onmouseover="cp('dcfg_${repeat/data/index}','buttons/x2');" onmouseout="cp('dcfg_${repeat/data/index}','buttons/x1');">
              <img src="assets/buttons/x1.gif" title="Einstellung löschen" name="dcfg_${repeat/data/index}" />
            </div>
          </td>
        </tr>
      </table>
    </metal:macro>
    <metal:macro metal:use-macro="dockprivilegelist" />
  </div>
  <br />
  <table class="tcal">
    <tr>
      <th colspan="2">Neuer Eintrag</th>
    </tr>
    <tr>
      <td>
        <select id="docktype" onchange="$('dock_opt1').hide();$('dock_opt2').hide();$('dock_opt3').hide();$('dock_opt'+this.value).show();">
          <option value="1">Siedler</option>
          <option value="2">Allianz</option>
          <option value="3">Rasse</option>
        </select>
      </td>
      <td>
					<span id="dock_opt1">
						Siedler-ID: <input type="text" size="6" name="docktarget" id="docktarget_1" />
					</span>
        <span id="dock_opt2" style="display: none;">
						Allianz-ID: <input type="text" size="6" id="docktarget_2" name="docktarget" />
					</span>
        <span id="dock_opt3" style="display: none;">
						Rasse: <select name="docktarget" id="docktarget_3">
							<option value="1">Föderation</option>
							<option value="2">Romulaner</option>
							<option value="3">Klingonen</option>
							<option value="4">Cardassianer</option>
							<option value="5">Ferengi</option>
						</select>
					</span>
        <select id="dockmode">
          <option value="1">Erlauben</option>
          <option value="2">Verbieten</option>
        </select>
      </td>
    </tr>
    <tr>
      <td colspan="2" style="text-align: center;">
        <input class="button" type="button" value="Erstellen" onclick="addDockPrivilege();" />
      </td>
    </tr>
  </table>
</metal:block>
<metal:macro metal:define-macro="trademenu">
  <div id="trademenucontent" style="width: 400px;">
    <tal:block tal:condition="THIS/getInformation">
      <br />
      <metal:macro metal:use-macro="html/sitemacros.xhtml/systeminformation" />
    </tal:block>
    <tal:block tal:condition="HAS_LICENSE">
      <form method="post" action="ship.php">
        <input type="hidden" name="id" tal:attributes="value SHIP/getId" />
        <input type="hidden" name="postid" tal:attributes="value TRADEPOST/getId" />
        <input type="hidden" name="sstr" tal:attributes="value THIS/getSessionString" />
        <br />
        <table class="tcal">
          <tr>
            <th style="width: 50%;">Warenkonto</th>
            <th>Schiff</th>
          </tr>
          <tr>
            <td>
              <img src="assets/buttons/lager.gif" />
              <span tal:replace="TRADEPOST/getStorageSum">SUM</span>/<span tal:replace="TRADEPOST/getStorageCapacity">MAX</span>
            </td>
            <td>
              <img src="assets/buttons/lager.gif" />
              <span tal:replace="SHIP/getStorageSum">SUM</span>/<span tal:replace="SHIP/getRump/getStorage">MAX</span>
            </td>
          </tr>
        </table>
        <br />
        <table class="tcal">
          <tr>
            <th>Modus</th>
          </tr>
          <tr>
            <td style="width: 50%" class="selected" id="transfertoaccount">
              <a style="display: block;" href="javascript:void(0);" onclick="switchTransferToAccount(${TRADEPOST/getId})">Transfer in Konto</a>
            </td>
            <td style="width: 50%" id="transferfromaccount">
              <a style="display: block;" href="javascript:void(0);" onclick="switchTransferFromAccount(${TRADEPOST/getId})">Transfer von Konto</a>
            </td>
          </tr>
        </table>

        <div id="trademenutransfer">
          <metal:macro metal:define-macro="transfertoaccount">
            <br />
            <input type="hidden" name="B_TRANSFER_TO_ACCOUNT" value="1" />
            <table class="tcal">
              <tr>
                <th>Waren auf dem Schiff</th>
              </tr>
              <tr>
                <td>
                  <tal:block tal:condition="SHIP/getStorage" tal:repeat="good SHIP/getStorage">
                    <input type="hidden" name="goods[]" tal:attributes="value good/getCommodity/getId" />
                    <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
                      <metal:macro
                        metal:use-macro="macros.xhtml/commoditySelection"
                        tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
                      />
                    </div>
                    <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
                      <metal:macro
                        metal:use-macro="macros.xhtml/commoditySelection"
                        tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
                      />
                    </div>
                    <br tal:condition="repeat/good/odd" style="clear: both;" />
                  </tal:block>
                  <tal:block tal:condition="not:SHIP/getStorage">
                    Keine Waren vorhanden
                  </tal:block>
                </td>
              </tr>
            </table>
          </metal:macro>
          <metal:macro metal:define-macro="transferfromaccount">
            <br />
            <input type="hidden" name="B_TRANSFER_FROM_ACCOUNT" value="1" />
            <table class="tcal">
              <tr>
                <th>Waren im Konto</th>
              </tr>
              <tr>
                <td tal:define="storage TRADEPOST/getStorage">
                  <tal:block tal:condition="storage" tal:repeat="good storage">
                    <input type="hidden" name="goods[]" tal:attributes="value good/getGoodId" />
                    <div tal:condition="repeat/good/odd" style="float: right; width: 50%;">
                      <metal:macro
                        metal:use-macro="macros.xhtml/commoditySelection"
                        tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
                      />
                    </div>
                    <div tal:condition="repeat/good/even" style="float: left; width: 50%;">
                      <metal:macro
                        metal:use-macro="macros.xhtml/commoditySelection"
                        tal:define="name good/getCommodity/getName; commodityId good/getCommodity/getId; amount good/getAmount"
                      />
                    </div>
                    <br tal:condition="repeat/good/odd" style="clear: both;" />
                  </tal:block>
                  <tal:block tal:condition="not:storage">
                    Keine Waren vorhanden
                  </tal:block>
                </td>
              </tr>
            </table>
          </metal:macro>
          <metal:macro metal:use-macro="transfertoaccount" />
        </div>
        <br />
        <div style="width: 100%; text-align: center;">
          <input type="submit" class="button" value="Transferieren" />
        </div>
      </form>
    </tal:block>
    <tal:block tal:condition="not:HAS_LICENSE">
      <table class="tcal">
        <tr>
          <td tal:content="structure nl2br:TRADEPOST/getTradePostDescription">DESCRIPTION</td>
        </tr>
      </table>
      <br />
      <table class="tcal" tal:condition="CAN_BUY_LICENSE">
        <tr>
          <th>Lizenz erwerben</th>
        </tr>
        <tr>
          <td>
            Um an diesem Posten Handel betreiben zu können ist eine Lizenz nötig. Die einmalige Gebühr dafür beträgt: <span tal:replace="TRADEPOST/getTradeLicenseCosts">COST</span> <span tal:replace="TRADEPOST/getTradeLicenseCostsCommodity/getName">GOOD</span><br /><br />
            Diese Gebühr kann entweder über ein bereits bestehendes Warenkonto an einem anderen Posten oder aus dem Frachtraum des Schiffes beglichen werden.<br /><br />
            <input class="button" type="button" value="Bezahlmethode wählen" onclick="tradeMenuChoosePayment(${TRADEPOST/getId});" />

          </td>
        </tr>
      </table>
      <table class="tcal" tal:condition="not:CAN_BUY_LICENSE">
        <tr>
          <th>Lizenzerwerb nicht möglich</th>
        </tr>
        <tr>
          <td>
            Du hast bereits die Maximalzahl an Handelslizenzen (<span tal:replace="php:MAX_TRADELICENCE_COUNT">MAXCOUNT</span>) und kannst daher keine weitere erwerben.
          </td>
        </tr>
      </table>
    </tal:block>
  </div>
</metal:macro>
<metal:macro metal:define-macro="trademenupayment">
  <table class="tcal">
    <tr>
      <td>
        Es werden nur angedockte Schiffe/Konten aufgelistet auf denen genug Waren vorhanden sind um die Gebühr zu begleichen.<br /><br />
        <img src="assets/goods/${TRADEPOST/getTradeLicenseCostsCommodity/getId}.gif" tal:attributes="title TRADEPOST/getTradeLicenseCostsCommodity/getName" /> <span tal:replace="TRADEPOST/getTradeLicenseCosts">COST</span>
      </td>
    </tr>
  </table>
  <br /><br />
  <input type="hidden" name="sstrajax" id="sstrajax" tal:attributes="value THIS/getSessionString" />
  <table class="tcal">
    <tr>
      <th>Bezahlmethode wählen</th>
    </tr>
    <tr>
      <td>
        <div style="float: left; width: 190px;">
          <strong>Angedockte Schiffe</strong>
          <div tal:repeat="ship DOCKED_SHIPS_FOR_LICENSE">
            - <a href="javascript:void(0);" onclick="payTradeLicence(${TRADEPOST/getId},'ship',${ship/getId})" tal:content="structure bbcode:ship/getName">NAME</a>
          </div>
        </div>
        <div style="padding-left: 6px; float: right; width: 190px;">
          <strong>Warenkonten</strong>
          <div tal:repeat="acc ACCOUNTS_FOR_LICENSE">
            - <a href="javascript:void(0);" onclick="payTradeLicence(${TRADEPOST/getId},'account',${acc/getTradePostId})" tal:content="structure acc/getTradePost/getName">NAME</a>
          </div>
        </div>
      </td>
    </tr>
  </table>
</metal:macro>
<metal:macro metal:define-macro="regioninfo">
  <tal:block tal:condition="THIS/getInformation">
    <br />
    <metal:macro metal:use-macro="html/sitemacros.xhtml/systeminformation" />
  </tal:block>
  <metal:macro metal:use-macro="html/databasemacros.xhtml/regioninfo" />
</metal:macro>
<metal:macro metal:define-macro="sectorscan">
  <tal:block tal:condition="THIS/getInformation">
    <br />
    <metal:macro metal:use-macro="html/sitemacros.xhtml/systeminformation" />
  </tal:block>
  <br />
  <table class="tcal">
    <tr>
      <td rowspan="2" style="width: 30px; vertical-align: top;">
        <img src="assets/map/${SHIP/getCurrentMapField/getFieldId}.gif" />
      </td>
      <th tal:content="SHIP/getCurrentMapField/getFieldType/getName">NAME</th>
    </tr>
    <tr>
      <td>
        Energiekosten: ${SHIP/getCurrentMapField/getFieldType/getEnergyCosts}<br />
        Schaden: ${SHIP/getCurrentMapField/getFieldType/getSpecialDamage} (${SHIP/getCurrentMapField/getFieldType/getDamage})
      </td>
    </tr>
  </table>
</metal:macro>
<metal:macro metal:define-macro="colonization">
  <div tal:attributes="class COLONY_SURFACE/getSurfaceTileCssClass" tal:define="sstr THIS/getSessionString">
    <tal:block  tal:repeat="field COLONY_SURFACE/getSurface">
      <div style="width: 40px; height: 40px;" tal:attributes="class field/getCssClass">
        <div>
          <div>
            <img tal:condition="not:field/isColonizeAble" style="width: 40px; height: 40px;" title="runtime" tal:attributes="title field/getTitleString" src="assets/generated/fields/${field/getFieldType}.png" />
            <a tal:condition="field/isColonizeAble" href="?id=${SHIP/getId}&B_COLONIZE=1&colid=${currentColony/getId}&field=${field/getId}&sstr=${sstr}">
              <img style="width: 40px; height: 40px;" title="runtime" tal:attributes="title field/getTitleString" src="assets/generated/fields/${field/getFieldType}.png" />
            </a>
          </div>
        </div>
      </div>
    </tal:block>
  </div>
  <tal:block tal:condition="currentColony/getPlanetType/getColonizeableFields">
    <br />
    <div class="divhead">Kolonisierbare Felder</div>
    <div class="divbody">
      <img src="assets/generated/fields/${field}.png" tal:repeat="field currentColony/getPlanetType/getColonizeableFields" />
    </div>
  </tal:block>
</metal:macro>
</html>
