{% from 'html/macros.twig' import pmWindow, userProfile %}
{% block body %}
<script src="{{ JAVASCRIPTPATH }}/js/ally.js"></script>
<table class="tcal">
    <tr>
        <th></th>
        <th>Mitglied</th>
        <th>Kolonien</th>
        <th>Schiffe</th>
        <th>Verwaltung</th>
    </tr>
    {% for data in MEMBER_LIST %}
    {% set id = data.getId %}
    <tr>
        <td style="width: 36px;">
            {{ userProfile(data.getId) }}
            {{ pmWindow(USER, data.getId) }}
        </td>
        <td>
            <div style="font-size: 120%">
                <img src="assets/rassen/{{ data.getFaction }}s.png" />
                <span>{{ data.getName|bbcode }}</span>
            </div>
            {% if CAN_VIEW_MEMBER_DATA %}
            <div>
                <img src="assets/buttons/time.png" title="Zuletzt online" />
                <span>{{ data.getLastActionDate|stuDateTime }}</span>
            </div>
            <div>
                <img src="/assets/navigation/menu_ships0.png" height="20" width="20"
                    title="Crew auf Schiffen/Stationen" />
                <span>{{ data.getCrewOnShips }}</span> / <span>{{ data.getCrewLimit }}</span>
                <img src="/assets/bev/bev_free_5_1.png" height="20" width="20" title="globales Crewlimit" />
            </div>
            {% endif %}
        </td>
        <td>
            {% if CAN_VIEW_COLONIES %}
            {% for col in data.getColonies %}
            <img src="assets/planets/{{ col.getColonyClass.getId }}.png"
                title="{{ col.getName|bbcode2txt }} {{ col.getSectorString }}" />
            {% endfor %}
            {% else %}
            Keine Berechtigung
            {% endif %}
        </td>
        <td>
            {% if CAN_VIEW_SHIPS %}
            {% for rump in data.getShipRumpList %}
            <div style="display: inline-block; padding-left: 10px; text-align: center;">
                {{ rump.amount }} {{ rump.name }}<br />
                <a href="javascript:void(0);" onclick="showMemberRumpInfo(this, {{ data.getId }}, {{ rump.rump_id }});">
                    <img src="assets/ships/{{ rump.rump_id }}.png" title="{{ rump.name }} (Klick für Details)" />
                </a>
            </div>
            {% endfor %}
            {% else %}
            Keine Berechtigung
            {% endif %}
        </td>
        <td style="width: 200px; text-align: center;">
            {% if CAN_MANAGE_JOBS %}
            {% if not data.isCurrentUser %}
            {% if not data.isFounder %}
            <a href="javascript:void(0);" class="linkbutton"
                onclick="toggleVisible('promote{{ data.getId }}');">Befördern</a>
            <div id="promote{{ data.getId }}"
                style="border-top: 1px solid #262323; margin-top: 10px; padding-top: 10px; display: none;">
                {% for job in ALLIANCE_JOBS %}
                <a href="alliance.php?B_PROMOTE_USER=1&type={{ job.getId }}&uid={{ data.getId }}&sstr={{ SESSIONSTRING }}"
                    class="linkbutton">{{ job.getTitle }}</a><br /><br />
                {% endfor %}
            </div>
            {% if data.canBeDemoted %}
            <br /><br />
            <a href="alliance.php?B_DEMOTE_USER=1&uid={{ data.getId }}&sstr={{ SESSIONSTRING }}"
                class="linkbutton negative">Degradieren</a>
            {% endif %}
            {% endif %}
            {% endif %}
            {% if data.canBeKicked %}
            <br />
            <br />
            {% if not data.isCurrentUser %}
            <a href="alliance.php?B_KICK_USER=1&SHOW_MANAGEMENT=1&uid={{ data.getId }}&sstr={{ SESSIONSTRING }}"
                class="linkbutton negative">Rauswerfen</a>
            {% endif %}
            {% endif %}
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}